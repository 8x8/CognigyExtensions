parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"JE2T":[function(require,module,exports) {
if(!window.__COGNIGY_WEBCHAT)throw new Error("Cognigy Webchat v2.7 or higher has to be loaded before this plugin");module.exports=window.__COGNIGY_WEBCHAT.React;
},{}],"Ejll":[function(require,module,exports) {
"use strict";var a=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(exports,"__esModule",{value:!0});var e=a(require("react")),h=function(a){var h=a.buttonTheme,t=a.buttonClassName,l=a.onClick,f=h.split("_"),v="dark"===f[0],z={cursor:"pointer"};return f[1]?e.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"104",height:"41",style:z,className:t,onClick:l},e.default.createElement("path",{fill:v?"#2f2f2f":"#ffffff",d:"M0 0h104v41H0z"}),!v&&e.default.createElement("path",{fill:"#8c8c8c",d:"M103 1v39H1V1h102m1-1H0v41h104V0z"}),e.default.createElement("path",{fill:"#f25022",d:"M13 11h9v9h-9z"}),e.default.createElement("path",{fill:"#00a4ef",d:"M13 21h9v9h-9z"}),e.default.createElement("path",{fill:"#7fba00",d:"M23 11h9v9h-9z"}),e.default.createElement("path",{fill:"#ffb900",d:"M23 21h9v9h-9z"}),e.default.createElement("path",{fill:v?"#ffffff":"#5e5e5e",d:"M45.812 25.082v-1.794a2.77 2.77 0 0 0 .573.4 4.484 4.484 0 0 0 .706.3 5.486 5.486 0 0 0 .745.187 3.954 3.954 0 0 0 .687.065 2.928 2.928 0 0 0 1.634-.365 1.2 1.2 0 0 0 .537-1.062 1.167 1.167 0 0 0-.178-.649 1.939 1.939 0 0 0-.5-.5 5.412 5.412 0 0 0-.757-.435q-.435-.209-.932-.436-.533-.285-.994-.578a4.285 4.285 0 0 1-.8-.648 2.724 2.724 0 0 1-.533-.8 2.6 2.6 0 0 1-.194-1.047 2.416 2.416 0 0 1 .333-1.285 2.794 2.794 0 0 1 .877-.9 4.019 4.019 0 0 1 1.239-.528 5.906 5.906 0 0 1 1.418-.172 5.692 5.692 0 0 1 2.4.374v1.721a3.817 3.817 0 0 0-2.295-.645 4.093 4.093 0 0 0-.771.074 2.335 2.335 0 0 0-.687.241 1.5 1.5 0 0 0-.494.433 1.06 1.06 0 0 0-.189.637 1.221 1.221 0 0 0 .145.608 1.573 1.573 0 0 0 .428.468 4.321 4.321 0 0 0 .688.414c.27.134.584.28.939.436q.548.285 1.034.6a4.881 4.881 0 0 1 .856.7 3.075 3.075 0 0 1 .585.846 2.493 2.493 0 0 1 .215 1.058 2.625 2.625 0 0 1-.322 1.348 2.584 2.584 0 0 1-.866.892 3.786 3.786 0 0 1-1.254.5 6.959 6.959 0 0 1-1.5.155c-.176 0-.392-.014-.647-.04s-.518-.067-.786-.117a7.75 7.75 0 0 1-.76-.187 2.373 2.373 0 0 1-.58-.269zM55.109 16.426a1.021 1.021 0 0 1-.713-.272.891.891 0 0 1-.3-.688.917.917 0 0 1 .3-.7 1.009 1.009 0 0 1 .713-.278 1.041 1.041 0 0 1 .732.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.035 1.035 0 0 1-.732.282zm.841 9.074h-1.7V18h1.7zM64.979 24.9q0 4.131-4.146 4.131a6.166 6.166 0 0 1-2.551-.491v-1.554a4.712 4.712 0 0 0 2.332.7 2.341 2.341 0 0 0 2.668-2.628v-.818h-.029a2.938 2.938 0 0 1-4.733.436 4.046 4.046 0 0 1-.837-2.684 4.738 4.738 0 0 1 .9-3.04 2.988 2.988 0 0 1 2.471-1.128 2.38 2.38 0 0 1 2.2 1.216h.029V18h1.7zM63.3 22.064v-.973a1.91 1.91 0 0 0-.523-1.352 1.71 1.71 0 0 0-1.3-.559 1.789 1.789 0 0 0-1.51.714 3.223 3.223 0 0 0-.545 2 2.78 2.78 0 0 0 .523 1.769 1.675 1.675 0 0 0 1.385.662 1.8 1.8 0 0 0 1.426-.632 2.4 2.4 0 0 0 .544-1.629zM73.853 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.616 1.616 0 0 0-1.279.582 2.167 2.167 0 0 0-.505 1.469V25.5h-1.7V18h1.7v1.245h.029a2.669 2.669 0 0 1 2.428-1.421 2.257 2.257 0 0 1 1.863.795 3.57 3.57 0 0 1 .644 2.3zM80.892 16.426a1.017 1.017 0 0 1-.713-.272.889.889 0 0 1-.3-.688.915.915 0 0 1 .3-.7 1 1 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.84 9.074h-1.7V18h1.7zM90.614 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.62 1.62 0 0 0-1.28.582 2.167 2.167 0 0 0-.5 1.469V25.5h-1.7V18h1.7v1.245h.03a2.668 2.668 0 0 1 2.427-1.421 2.258 2.258 0 0 1 1.864.795 3.576 3.576 0 0 1 .643 2.3z"})):e.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"215",height:"41",style:z,className:t,onClick:l},e.default.createElement("path",{fill:v?"#2f2f2f":"#ffffff",d:"M0 0h215v41H0z"}),!v&&e.default.createElement("path",{fill:"#8c8c8c",d:"M214 1v39H1V1h213m1-1H0v41h215V0z"}),e.default.createElement("path",{fill:v?"#ffffff":"#5e5e5e",d:"M45.812 25.082v-1.794a2.77 2.77 0 0 0 .573.4 4.484 4.484 0 0 0 .706.3 5.486 5.486 0 0 0 .745.187 3.954 3.954 0 0 0 .687.065 2.928 2.928 0 0 0 1.634-.365 1.2 1.2 0 0 0 .537-1.062 1.167 1.167 0 0 0-.178-.649 1.939 1.939 0 0 0-.5-.5 5.412 5.412 0 0 0-.757-.435q-.435-.209-.932-.436-.533-.285-.994-.578a4.285 4.285 0 0 1-.8-.648 2.724 2.724 0 0 1-.533-.8 2.6 2.6 0 0 1-.194-1.047 2.416 2.416 0 0 1 .333-1.285 2.794 2.794 0 0 1 .877-.9 4.019 4.019 0 0 1 1.239-.528 5.906 5.906 0 0 1 1.418-.172 5.692 5.692 0 0 1 2.4.374v1.721a3.817 3.817 0 0 0-2.295-.645 4.093 4.093 0 0 0-.771.074 2.335 2.335 0 0 0-.687.241 1.5 1.5 0 0 0-.494.433 1.06 1.06 0 0 0-.189.637 1.221 1.221 0 0 0 .145.608 1.573 1.573 0 0 0 .428.468 4.321 4.321 0 0 0 .688.414c.27.134.584.28.939.436q.548.285 1.034.6a4.881 4.881 0 0 1 .856.7 3.075 3.075 0 0 1 .585.846 2.493 2.493 0 0 1 .215 1.058 2.625 2.625 0 0 1-.322 1.348 2.584 2.584 0 0 1-.866.892 3.786 3.786 0 0 1-1.254.5 6.959 6.959 0 0 1-1.5.155c-.176 0-.392-.014-.647-.04s-.518-.067-.786-.117a7.75 7.75 0 0 1-.76-.187 2.373 2.373 0 0 1-.58-.269zM55.109 16.426a1.021 1.021 0 0 1-.713-.272.891.891 0 0 1-.3-.688.917.917 0 0 1 .3-.7 1.009 1.009 0 0 1 .713-.278 1.041 1.041 0 0 1 .732.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.035 1.035 0 0 1-.732.282zm.841 9.074h-1.7V18h1.7zM64.979 24.9q0 4.131-4.146 4.131a6.166 6.166 0 0 1-2.551-.491v-1.554a4.712 4.712 0 0 0 2.332.7 2.341 2.341 0 0 0 2.668-2.628v-.818h-.029a2.938 2.938 0 0 1-4.733.436 4.046 4.046 0 0 1-.837-2.684 4.738 4.738 0 0 1 .9-3.04 2.988 2.988 0 0 1 2.471-1.128 2.38 2.38 0 0 1 2.2 1.216h.029V18h1.7zM63.3 22.064v-.973a1.91 1.91 0 0 0-.523-1.352 1.71 1.71 0 0 0-1.3-.559 1.789 1.789 0 0 0-1.51.714 3.223 3.223 0 0 0-.545 2 2.78 2.78 0 0 0 .523 1.769 1.675 1.675 0 0 0 1.385.662 1.8 1.8 0 0 0 1.426-.632 2.4 2.4 0 0 0 .544-1.629zM73.853 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.616 1.616 0 0 0-1.279.582 2.167 2.167 0 0 0-.505 1.469V25.5h-1.7V18h1.7v1.245h.029a2.669 2.669 0 0 1 2.428-1.421 2.257 2.257 0 0 1 1.863.795 3.57 3.57 0 0 1 .644 2.3zM80.892 16.426a1.017 1.017 0 0 1-.713-.272.889.889 0 0 1-.3-.688.915.915 0 0 1 .3-.7 1 1 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.84 9.074h-1.7V18h1.7zM90.614 25.5h-1.7v-4.227q0-2.1-1.483-2.1a1.62 1.62 0 0 0-1.28.582 2.167 2.167 0 0 0-.5 1.469V25.5h-1.7V18h1.7v1.245h.03a2.668 2.668 0 0 1 2.427-1.421 2.258 2.258 0 0 1 1.864.795 3.576 3.576 0 0 1 .643 2.3zM106.865 18l-2.208 7.5h-1.776l-1.36-5.083a3.291 3.291 0 0 1-.1-.659h-.029a3.018 3.018 0 0 1-.132.644l-1.477 5.1h-1.741l-2.2-7.5H97.6l1.36 5.405a3.308 3.308 0 0 1 .087.645h.053a3.384 3.384 0 0 1 .117-.659L100.725 18h1.593l1.345 5.428a3.832 3.832 0 0 1 .095.644h.052a3.3 3.3 0 0 1 .109-.644l1.33-5.428zM108.977 16.426a1.017 1.017 0 0 1-.713-.272.889.889 0 0 1-.3-.688.915.915 0 0 1 .3-.7 1 1 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.915.915 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.84 9.074h-1.7V18h1.7zM115.979 25.42a2.944 2.944 0 0 1-1.307.248q-2.18 0-2.179-2.094v-4.241h-1.25V18h1.25v-1.736l1.7-.483V18h1.79v1.333h-1.79v3.75a1.478 1.478 0 0 0 .242.952 1 1 0 0 0 .8.285 1.16 1.16 0 0 0 .745-.248zM124.094 25.5h-1.7v-4.1q0-2.226-1.483-2.226a1.555 1.555 0 0 0-1.258.644 2.573 2.573 0 0 0-.511 1.649V25.5h-1.7V14.4h1.7v4.849h.029a2.679 2.679 0 0 1 2.428-1.421q2.492 0 2.492 3.055zM141.719 25.5h-1.726v-6.8q0-.835.1-2.043h-.03a6.992 6.992 0 0 1-.285.988l-3.126 7.855h-1.2l-3.136-7.793a7.371 7.371 0 0 1-.277-1.047h-.029q.059.63.058 2.058V25.5h-1.608V15h2.449l2.756 7a10.415 10.415 0 0 1 .409 1.2h.036c.181-.551.327-.962.439-1.23l2.808-6.97h2.362zM144.964 16.426a1.019 1.019 0 0 1-.713-.272.892.892 0 0 1-.3-.688.918.918 0 0 1 .3-.7 1.007 1.007 0 0 1 .713-.278 1.038 1.038 0 0 1 .731.278.911.911 0 0 1 .3.7.9.9 0 0 1-.3.678 1.033 1.033 0 0 1-.731.282zm.841 9.074h-1.7V18h1.7zM153.378 25.156a4.185 4.185 0 0 1-2.127.52 3.6 3.6 0 0 1-2.69-1.044 3.7 3.7 0 0 1-1.024-2.706 4.074 4.074 0 0 1 1.1-2.978 3.93 3.93 0 0 1 2.942-1.124 4.281 4.281 0 0 1 1.806.36v1.582a2.73 2.73 0 0 0-1.667-.586 2.312 2.312 0 0 0-1.762.728 2.669 2.669 0 0 0-.687 1.908 2.54 2.54 0 0 0 .647 1.838 2.291 2.291 0 0 0 1.736.674 2.708 2.708 0 0 0 1.725-.652zM159.4 19.619a1.4 1.4 0 0 0-.884-.242 1.514 1.514 0 0 0-1.258.682 3.047 3.047 0 0 0-.5 1.852V25.5h-1.7V18h1.7v1.545h.029a2.6 2.6 0 0 1 .764-1.233 1.72 1.72 0 0 1 1.151-.444 1.425 1.425 0 0 1 .7.14zM163.788 25.676a3.71 3.71 0 0 1-2.767-1.051 3.8 3.8 0 0 1-1.035-2.787 3.7 3.7 0 0 1 3.985-4.014 3.581 3.581 0 0 1 2.733 1.033 3.994 3.994 0 0 1 .98 2.864 3.938 3.938 0 0 1-1.056 2.875 3.8 3.8 0 0 1-2.84 1.08zm.08-6.5a1.932 1.932 0 0 0-1.571.7 2.913 2.913 0 0 0-.578 1.919 2.744 2.744 0 0 0 .585 1.856 1.957 1.957 0 0 0 1.564.678 1.862 1.862 0 0 0 1.539-.666 2.95 2.95 0 0 0 .537-1.9 2.99 2.99 0 0 0-.537-1.911 1.851 1.851 0 0 0-1.539-.672zM168.94 25.266v-1.575a3.383 3.383 0 0 0 2.1.725q1.535 0 1.535-.908a.714.714 0 0 0-.132-.436 1.263 1.263 0 0 0-.354-.318 2.864 2.864 0 0 0-.526-.25c-.2-.072-.428-.155-.677-.248a7.074 7.074 0 0 1-.829-.389 2.526 2.526 0 0 1-.615-.465 1.758 1.758 0 0 1-.369-.59 2.168 2.168 0 0 1-.124-.769 1.775 1.775 0 0 1 .256-.955 2.224 2.224 0 0 1 .687-.7 3.294 3.294 0 0 1 .979-.425 4.49 4.49 0 0 1 1.129-.139 5.163 5.163 0 0 1 1.856.315v1.487a3.127 3.127 0 0 0-1.812-.542 2.323 2.323 0 0 0-.582.066 1.477 1.477 0 0 0-.442.183.893.893 0 0 0-.285.282.677.677 0 0 0-.1.363.779.779 0 0 0 .1.41.936.936 0 0 0 .3.3 2.675 2.675 0 0 0 .482.234q.282.105.648.23a9.5 9.5 0 0 1 .866.4 2.872 2.872 0 0 1 .654.465 1.789 1.789 0 0 1 .416.6 2.034 2.034 0 0 1 .147.81 1.855 1.855 0 0 1-.263 1 2.212 2.212 0 0 1-.7.7 3.28 3.28 0 0 1-1.013.413 5.2 5.2 0 0 1-1.209.136 5.1 5.1 0 0 1-2.123-.41zM179.183 25.676a3.711 3.711 0 0 1-2.768-1.051 3.8 3.8 0 0 1-1.034-2.787 3.7 3.7 0 0 1 3.984-4.014 3.585 3.585 0 0 1 2.734 1.033 3.993 3.993 0 0 1 .979 2.864 3.934 3.934 0 0 1-1.056 2.875 3.794 3.794 0 0 1-2.839 1.08zm.08-6.5a1.934 1.934 0 0 0-1.572.7 2.919 2.919 0 0 0-.578 1.919 2.749 2.749 0 0 0 .585 1.856 1.959 1.959 0 0 0 1.565.678 1.864 1.864 0 0 0 1.539-.666 2.956 2.956 0 0 0 .537-1.9 3 3 0 0 0-.537-1.911 1.852 1.852 0 0 0-1.539-.672zM188.787 15.781a1.523 1.523 0 0 0-.782-.2q-1.235 0-1.235 1.4V18h1.74v1.333h-1.733V25.5h-1.7v-6.167H183.8V18h1.279v-1.216a2.37 2.37 0 0 1 .775-1.871 2.817 2.817 0 0 1 1.937-.684 2.866 2.866 0 0 1 .994.138zM193.94 25.42a2.944 2.944 0 0 1-1.307.248q-2.179 0-2.179-2.094v-4.241H189.2V18h1.25v-1.736l1.7-.483V18h1.79v1.333h-1.79v3.75a1.472 1.472 0 0 0 .242.952 1 1 0 0 0 .8.285 1.162 1.162 0 0 0 .745-.248z"}),e.default.createElement("path",{fill:"#f25022",d:"M13 11h9v9h-9z"}),e.default.createElement("path",{fill:"#00a4ef",d:"M13 21h9v9h-9z"}),e.default.createElement("path",{fill:"#7fba00",d:"M23 11h9v9h-9z"}),e.default.createElement("path",{fill:"#ffb900",d:"M23 21h9v9h-9z"}))};exports.default=h;
},{"react":"JE2T"}],"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=u,exports.__generator=c,exports.__createBinding=f,exports.__exportStar=l,exports.__values=s,exports.__read=p,exports.__spread=y,exports.__spreadArrays=_,exports.__await=h,exports.__asyncGenerator=v,exports.__asyncDelegator=d,exports.__asyncValues=b,exports.__makeTemplateObject=w,exports.__importStar=x,exports.__importDefault=m,exports.__classPrivateFieldGet=O,exports.__classPrivateFieldSet=g,exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(e){a(e)}}function u(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,u)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(u){a=[6,u],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function f(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}function l(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function h(t){return this instanceof h?(this.v=t,this):new h(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||u(t,e)})})}function u(t,e){try{(r=o[t](e)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function c(t){u("next",t)}function f(t){u("throw",t)}function l(t,e){t(e),a.shift(),a.length&&u(a[0][0],a[0][1])}}function d(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:h(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function m(t){return t&&t.__esModule?t:{default:t}}function O(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function g(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}exports.__assign=r;
},{}],"Vl5M":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CryptoUtils=void 0;var e=function(){function e(){}return e.createNewGuid=function(){var o=window.crypto;if(o&&o.getRandomValues){var r=new Uint8Array(16);return o.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",t="0123456789abcdef",n=0,x="",i=0;i<36;i++)"-"!==a[i]&&"4"!==a[i]&&(n=16*Math.random()|0),"x"===a[i]?x+=t[n]:"y"===a[i]?(n&=3,x+=t[n|=8]):x+=a[i];return x},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var o=e.toString(16);o.length<2;)o="0"+o;return o},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,o){return String.fromCharCode(Number("0x"+o))}))},e.base64Decode=function(e){var o=e.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(o).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var o,r=/\+/g,a=/([^&=]+)=([^&]*)/g,t=function(e){return decodeURIComponent(e.replace(r," "))},n={};for(o=a.exec(e);o;)n[t(o[1])]=t(o[2]),o=a.exec(e);return n},e}();exports.CryptoUtils=e;
},{}],"kTX3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.libraryVersion=O,exports.FramePrefix=exports.PromptState=exports.NetworkRequestType=exports.BlacklistedEQParams=exports.SSOTypes=exports.WELL_KNOWN_SUFFIX=exports.AAD_INSTANCE_DISCOVERY_ENDPOINT=exports.DEFAULT_AUTHORITY=exports.ErrorCacheKeys=exports.PersistentCacheKeys=exports.TemporaryCacheKeys=exports.ResponseTypes=exports.ServerHashParamKeys=exports.Constants=void 0;var e,r=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();exports.Constants=r,exports.ServerHashParamKeys=e,function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(e||(exports.ServerHashParamKeys=e={}));var t,n,o,i={id_token:"id_token",token:"token",id_token_token:"id_token token"};exports.ResponseTypes=i,exports.TemporaryCacheKeys=t,function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(t||(exports.TemporaryCacheKeys=t={})),exports.PersistentCacheKeys=n,function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(n||(exports.PersistentCacheKeys=n={})),exports.ErrorCacheKeys=o,function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(o||(exports.ErrorCacheKeys=o={}));var c="https://login.microsoftonline.com/common/";exports.DEFAULT_AUTHORITY=c;var u=c+"/discovery/instance?api-version=1.1&authorization_endpoint=";exports.AAD_INSTANCE_DISCOVERY_ENDPOINT=u;var a,p=".well-known/openid-configuration";exports.WELL_KNOWN_SUFFIX=p,exports.SSOTypes=a,function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(a||(exports.SSOTypes=a={}));var s=[a.SID,a.LOGIN_HINT];exports.BlacklistedEQParams=s;var f={GET:"GET",POST:"POST"};exports.NetworkRequestType=f;var l={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};exports.PromptState=l;var b={ID_TOKEN_FRAME:"msalIdTokenFrame",TOKEN_FRAME:"msalRenewFrame"};function O(){return"1.4.4"}exports.FramePrefix=b;
},{}],"Oww8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthError=exports.AuthErrorMessage=void 0;var e=t(require("tslib"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function t(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){var u=n?Object.getOwnPropertyDescriptor(e,c):null;u&&(u.get||u.set)?Object.defineProperty(o,c,u):o[c]=e[c]}return o.default=e,t&&t.set(e,o),o}var o={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},noWindowObjectError:{code:"no_window_object",desc:"No window object available. Details:"}};exports.AuthErrorMessage=o;var n=function(r){function t(e,o){var n=r.call(this,o)||this;return Object.setPrototypeOf(n,t.prototype),n.errorCode=e,n.errorMessage=o,n.name="AuthError",n}return e.__extends(t,r),t.createUnexpectedError=function(e){return new t(o.unexpectedError.code,o.unexpectedError.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(o.noWindowObjectError.code,o.noWindowObjectError.desc+" "+e)},t}(Error);exports.AuthError=n;
},{"tslib":"vCxL"}],"fvWi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StringUtils=void 0;var t=function(){function t(){}return t.isEmpty=function(t){return void 0===t||!t||0===t.length},t.validateAndParseJsonCacheKey=function(t){try{var e=JSON.parse(t);return e&&"object"==typeof e?e:null}catch(r){return null}},t}();exports.StringUtils=t;
},{}],"WdOd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClientAuthError=exports.ClientAuthErrorMessage=void 0;var e=t(require("tslib")),r=require("./AuthError"),o=require("../utils/StringUtils");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function t(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n();if(r&&r.has(e))return r.get(e);var o={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){var i=t?Object.getOwnPropertyDescriptor(e,c):null;i&&(i.get||i.set)?Object.defineProperty(o,c,i):o[c]=e[c]}return o.default=e,r&&r.set(e,o),o}var c={multipleCacheAuthorities:{code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},tokenRenewalError:{code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},invalidIdToken:{code:"invalid_id_token",desc:"Invalid ID token format."},invalidStateError:{code:"invalid_state_error",desc:"Invalid state."},nonceMismatchError:{code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},loginProgressError:{code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},acquireTokenProgressError:{code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},callbackError:{code:"callback_error",desc:"Error occurred in token received callback function."},userLoginRequiredError:{code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},userDoesNotExistError:{code:"user_non_existent",desc:"User object does not exist. Please call a login API."},clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoNotPopulatedError:{code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},nullOrEmptyIdToken:{code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},idTokenNotParsed:{code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},tokenEncodingError:{code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},invalidInteractionType:{code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},cacheParseError:{code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},blockTokenRequestsInHiddenIframe:{code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"}};exports.ClientAuthErrorMessage=c;var i=function(r){function n(e,o){var t=r.call(this,e,o)||this;return t.name="ClientAuthError",Object.setPrototypeOf(t,n.prototype),t}return e.__extends(n,r),n.createEndpointResolutionError=function(e){var r=c.endpointResolutionError.desc;return e&&!o.StringUtils.isEmpty(e)&&(r+=" Details: "+e),new n(c.endpointResolutionError.code,r)},n.createMultipleAuthoritiesInCacheError=function(e){return new n(c.multipleCacheAuthorities.code,"Cache error for scope "+e+": "+c.multipleCacheAuthorities.desc+".")},n.createPopupWindowError=function(e){var r=c.popUpWindowError.desc;return e&&!o.StringUtils.isEmpty(e)&&(r+=" Details: "+e),new n(c.popUpWindowError.code,r)},n.createTokenRenewalTimeoutError=function(){return new n(c.tokenRenewalError.code,c.tokenRenewalError.desc)},n.createInvalidIdTokenError=function(e){return new n(c.invalidIdToken.code,c.invalidIdToken.desc+" Given token: "+e)},n.createInvalidStateError=function(e,r){return new n(c.invalidStateError.code,c.invalidStateError.desc+" "+e+", state expected : "+r+".")},n.createNonceMismatchError=function(e,r){return new n(c.nonceMismatchError.code,c.nonceMismatchError.desc+" "+e+", nonce expected : "+r+".")},n.createLoginInProgressError=function(){return new n(c.loginProgressError.code,c.loginProgressError.desc)},n.createAcquireTokenInProgressError=function(){return new n(c.acquireTokenProgressError.code,c.acquireTokenProgressError.desc)},n.createUserCancelledError=function(){return new n(c.userCancelledError.code,c.userCancelledError.desc)},n.createErrorInCallbackFunction=function(e){return new n(c.callbackError.code,c.callbackError.desc+" "+e+".")},n.createUserLoginRequiredError=function(){return new n(c.userLoginRequiredError.code,c.userLoginRequiredError.desc)},n.createUserDoesNotExistError=function(){return new n(c.userDoesNotExistError.code,c.userDoesNotExistError.desc)},n.createClientInfoDecodingError=function(e){return new n(c.clientInfoDecodingError.code,c.clientInfoDecodingError.desc+" Failed with error: "+e)},n.createClientInfoNotPopulatedError=function(e){return new n(c.clientInfoNotPopulatedError.code,c.clientInfoNotPopulatedError.desc+" Failed with error: "+e)},n.createIdTokenNullOrEmptyError=function(e){return new n(c.nullOrEmptyIdToken.code,c.nullOrEmptyIdToken.desc+" Raw ID Token Value: "+e)},n.createIdTokenParsingError=function(e){return new n(c.idTokenNotParsed.code,c.idTokenNotParsed.desc+" Failed with error: "+e)},n.createTokenEncodingError=function(e){return new n(c.tokenEncodingError.code,c.tokenEncodingError.desc+" Attempted to decode: "+e)},n.createInvalidInteractionTypeError=function(){return new n(c.invalidInteractionType.code,c.invalidInteractionType.desc)},n.createCacheParseError=function(e){var r="invalid key: "+e+", "+c.cacheParseError.desc;return new n(c.cacheParseError.code,r)},n.createBlockTokenRequestsInHiddenIframeError=function(){return new n(c.blockTokenRequestsInHiddenIframe.code,c.blockTokenRequestsInHiddenIframe.desc)},n}(r.AuthError);exports.ClientAuthError=i;
},{"tslib":"vCxL","./AuthError":"Oww8","../utils/StringUtils":"fvWi"}],"c3Oq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClientConfigurationError=exports.ClientConfigurationErrorMessage=void 0;var e=o(require("tslib")),r=require("./ClientAuthError");function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=t();if(r&&r.has(e))return r.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var a=i?Object.getOwnPropertyDescriptor(e,n):null;a&&(a.get||a.set)?Object.defineProperty(o,n,a):o[n]=e[n]}return o.default=e,r&&r.set(e,o),o}var i={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},storageNotSupported:{code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},b2cKnownAuthoritiesNotSet:{code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},invalidCorrelationIdError:{code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},ssoSilentError:{code:"sso_silent_error",desc:"request must contain either sid or login_hint"},invalidAuthorityMetadataError:{code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."}};exports.ClientConfigurationErrorMessage=i;var n=function(r){function t(e,o){var i=r.call(this,e,o)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,t.prototype),i}return e.__extends(t,r),t.createNoSetConfigurationError=function(){return new t(i.configurationNotSet.code,""+i.configurationNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(i.storageNotSupported.code,i.storageNotSupported.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(i.noRedirectCallbacksSet.code,i.noRedirectCallbacksSet.desc)},t.createInvalidCallbackObjectError=function(e){return new t(i.invalidCallbackObject.code,i.invalidCallbackObject.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(i.emptyScopes.code,i.emptyScopes.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(i.nonArrayScopes.code,i.nonArrayScopes.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(i.scopesRequired.code,i.scopesRequired.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(i.invalidPrompt.code,i.invalidPrompt.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(i.claimsRequestParsingError.code,i.claimsRequestParsingError.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=i.emptyRequestError;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(i.invalidCorrelationIdError.code,i.invalidCorrelationIdError.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(i.b2cKnownAuthoritiesNotSet.code,i.b2cKnownAuthoritiesNotSet.desc)},t.createInvalidAuthorityTypeError=function(){return new t(i.invalidAuthorityType.code,i.invalidAuthorityType.desc)},t.createUntrustedAuthorityError=function(e){return new t(i.untrustedAuthority.code,i.untrustedAuthority.desc+" Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var r=i.telemetryConfigError,o=r.code,n=r.desc,a={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(o,n+" mising values: "+Object.keys(a).reduce(function(r,t){return e[t]?r:r.concat([t+" ("+a[t]+")"])},[]).join(","))},t.createSsoSilentError=function(){return new t(i.ssoSilentError.code,i.ssoSilentError.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(i.invalidAuthorityMetadataError.code,i.invalidAuthorityMetadataError.desc)},t}(r.ClientAuthError);exports.ClientConfigurationError=n;
},{"tslib":"vCxL","./ClientAuthError":"WdOd"}],"gAsY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ScopeSet=void 0;var r=require("./error/ClientConfigurationError"),n=require("./utils/Constants"),e=function(){function e(){}return e.isIntersectingScopes=function(r,n){for(var e=this.trimAndConvertArrayToLowerCase(r.slice()),t=this.trimAndConvertArrayToLowerCase(n.slice()),o=0;o<t.length;o++)if(e.indexOf(t[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(r,n){var e=this.trimAndConvertArrayToLowerCase(r.slice());return this.trimAndConvertArrayToLowerCase(n.slice()).every(function(r){return e.indexOf(r.toString().toLowerCase())>=0})},e.trimAndConvertToLowerCase=function(r){return r.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(r){var n=this;return r.map(function(r){return n.trimAndConvertToLowerCase(r)})},e.trimScopes=function(r){return r.map(function(r){return r.trim()})},e.removeElement=function(r,n){var e=this.trimAndConvertToLowerCase(n);return r.filter(function(r){return r!==e})},e.parseScope=function(r){var n="";if(r)for(var e=0;e<r.length;++e)n+=e!==r.length-1?r[e]+" ":r[e];return n},e.validateInputScope=function(n,e){if(n){if(!Array.isArray(n))throw r.ClientConfigurationError.createScopesNonArrayError(n);if(n.length<1&&e)throw r.ClientConfigurationError.createEmptyScopesArrayError(n.toString())}else if(e)throw r.ClientConfigurationError.createScopesRequiredError(n)},e.getScopeFromState=function(r){if(r){var e=r.indexOf(n.Constants.resourceDelimiter);if(e>-1&&e+1<r.length)return r.substring(e+1)}return""},e.appendScopes=function(r,n){if(r){var e=n?this.trimAndConvertArrayToLowerCase(n.slice()):null,t=this.trimAndConvertArrayToLowerCase(r.slice());return e?t.concat(e):t}return null},e.onlyContainsOidcScopes=function(r){var e=r.length,t=0;return r.indexOf(n.Constants.openidScope)>-1&&(t+=1),r.indexOf(n.Constants.profileScope)>-1&&(t+=1),e>0&&e===t},e.containsAnyOidcScopes=function(r){var e=r.indexOf(n.Constants.openidScope)>-1,t=r.indexOf(n.Constants.profileScope)>-1;return e||t},e.onlyContainsClientId=function(r,n){return!!r&&r.indexOf(n)>-1&&1===r.length},e.appendDefaultScopes=function(r){var e=r;return-1===e.indexOf(n.Constants.openidScope)&&e.push(n.Constants.openidScope),-1===e.indexOf(n.Constants.profileScope)&&e.push(n.Constants.profileScope),e},e.removeDefaultScopes=function(r){return r.filter(function(r){return r!==n.Constants.openidScope&&r!==n.Constants.profileScope})},e.translateClientIdIfSingleScope=function(r,e){return this.onlyContainsClientId(r,e)?n.Constants.oidcScopes:r},e}();exports.ScopeSet=e;
},{"./error/ClientConfigurationError":"c3Oq","./utils/Constants":"kTX3"}],"vR5n":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UrlUtils=void 0;var e=require("./Constants"),t=require("../ScopeSet"),r=require("./StringUtils"),n=require("./CryptoUtils"),o=function(){function o(){}return o.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},o.createNavigationUrlString=function(e){var r=t.ScopeSet.appendDefaultScopes(e.scopes),n=[];return n.push("response_type="+e.responseType),n.push("scope="+encodeURIComponent(t.ScopeSet.parseScope(r))),n.push("client_id="+encodeURIComponent(e.clientId)),n.push("redirect_uri="+encodeURIComponent(e.redirectUri)),n.push("state="+encodeURIComponent(e.state)),n.push("nonce="+encodeURIComponent(e.nonce)),n.push("client_info=1"),n.push("x-client-SKU="+e.xClientSku),n.push("x-client-Ver="+e.xClientVer),e.promptValue&&n.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&n.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&n.push(e.queryParameters),e.extraQueryParameters&&n.push(e.extraQueryParameters),n.push("client-request-id="+encodeURIComponent(e.correlationId)),n},o.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},o.removeHashFromUrl=function(e){return e.split("#")[0]},o.replaceTenantPath=function(t,r){var n=t.toLowerCase(),o=this.GetUrlComponents(n),i=o.PathSegments;return!r||0===i.length||i[0]!==e.Constants.common&&i[0]!==e.SSOTypes.ORGANIZATIONS||(i[0]=r),this.constructAuthorityUriFromObject(o,i)},o.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},o.isCommonAuthority=function(t){var r=this.CanonicalizeUri(t),n=this.GetUrlComponents(r).PathSegments;return 0!==n.length&&n[0]===e.Constants.common},o.isOrganizationsAuthority=function(t){var r=this.CanonicalizeUri(t),n=this.GetUrlComponents(r).PathSegments;return 0!==n.length&&n[0]===e.SSOTypes.ORGANIZATIONS},o.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},o.CanonicalizeUri=function(e){return e&&(e=e.toLowerCase()),e&&!o.endsWith(e,"/")&&(e+="/"),e},o.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},o.urlRemoveQueryStringParameter=function(e,t){if(r.StringUtils.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e=e.replace(n,"")},o.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},o.urlContainsHash=function(t){var r=o.deserializeHash(t);return r.hasOwnProperty(e.ServerHashParamKeys.ERROR_DESCRIPTION)||r.hasOwnProperty(e.ServerHashParamKeys.ERROR)||r.hasOwnProperty(e.ServerHashParamKeys.ACCESS_TOKEN)||r.hasOwnProperty(e.ServerHashParamKeys.ID_TOKEN)},o.deserializeHash=function(e){var t=o.getHashFromUrl(e);return n.CryptoUtils.deserialize(t)},o.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},o}();exports.UrlUtils=o;
},{"./Constants":"kTX3","../ScopeSet":"gAsY","./StringUtils":"fvWi","./CryptoUtils":"Vl5M"}],"AF8p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AccessTokenKey=void 0;var e=require("../utils/CryptoUtils"),t=require("../utils/UrlUtils"),i=function(){return function(i,s,r,o,c){this.authority=t.UrlUtils.CanonicalizeUri(i),this.clientId=s,this.scopes=r,this.homeAccountIdentifier=e.CryptoUtils.base64Encode(o)+"."+e.CryptoUtils.base64Encode(c)}}();exports.AccessTokenKey=i;
},{"../utils/CryptoUtils":"Vl5M","../utils/UrlUtils":"vR5n"}],"FOs4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AccessTokenValue=void 0;var e=function(){return function(e,s,t,o){this.accessToken=e,this.idToken=s,this.expiresIn=t,this.homeAccountIdentifier=o}}();exports.AccessTokenValue=e;
},{}],"VFoY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ServerRequestParameters=void 0;var e=require("./utils/CryptoUtils"),t=require("./utils/Constants"),r=require("./utils/StringUtils"),s=require("./ScopeSet"),n=function(){function n(r,n,i,a,o,u,p){this.authorityInstance=r,this.clientId=n,this.nonce=e.CryptoUtils.createNewGuid(),this.scopes=o?o.slice():t.Constants.oidcScopes,this.scopes=s.ScopeSet.trimScopes(this.scopes),this.state=u,this.correlationId=p,this.xClientSku="MSAL.JS",this.xClientVer=(0,t.libraryVersion)(),this.responseType=i,this.redirectUri=a}return Object.defineProperty(n.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),n.prototype.populateQueryParams=function(e,t,r,s){var i={};t&&(t.prompt&&(this.promptValue=t.prompt),t.claimsRequest&&(this.claimsValue=t.claimsRequest),n.isSSOParam(t)&&(i=this.constructUnifiedCacheQueryParameter(t,null))),r&&(i=this.constructUnifiedCacheQueryParameter(null,r)),i=this.addHintParameters(e,i);var a=t?t.extraQueryParameters:null;this.queryParameters=n.generateQueryParametersString(i),this.extraQueryParameters=n.generateQueryParametersString(a,s)},n.prototype.constructUnifiedCacheQueryParameter=function(e,r){var s,n;if(e)if(e.account){var i=e.account;i.sid?(s=t.SSOTypes.SID,n=i.sid):i.userName&&(s=t.SSOTypes.LOGIN_HINT,n=i.userName)}else e.sid?(s=t.SSOTypes.SID,n=e.sid):e.loginHint&&(s=t.SSOTypes.LOGIN_HINT,n=e.loginHint);else r&&r.hasOwnProperty(t.Constants.upn)&&(s=t.SSOTypes.ID_TOKEN,n=r.upn);return this.addSSOParameter(s,n)},n.prototype.addHintParameters=function(e,s){e&&!s[t.SSOTypes.SID]&&(!s[t.SSOTypes.LOGIN_HINT]&&e.sid&&this.promptValue===t.PromptState.NONE?s=this.addSSOParameter(t.SSOTypes.SID,e.sid,s):!s[t.SSOTypes.LOGIN_HINT]&&e.userName&&!r.StringUtils.isEmpty(e.userName)&&(s=this.addSSOParameter(t.SSOTypes.LOGIN_HINT,e.userName,s)));return s},n.prototype.addSSOParameter=function(e,r,s){if(s||(s={}),!r)return s;switch(e){case t.SSOTypes.SID:s[t.SSOTypes.SID]=r;break;case t.SSOTypes.ID_TOKEN:case t.SSOTypes.LOGIN_HINT:s[t.SSOTypes.LOGIN_HINT]=r}return s},n.generateQueryParametersString=function(e,r){var s=null;return e&&Object.keys(e).forEach(function(n){n===t.Constants.domain_hint&&(r||e[t.SSOTypes.SID])||(null==s?s=n+"="+encodeURIComponent(e[n]):s+="&"+n+"="+encodeURIComponent(e[n]))}),s},n.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},n.determineResponseType=function(e,r){return s.ScopeSet.onlyContainsOidcScopes(r)?t.ResponseTypes.id_token:e?this.responseTypeForMatchingAccounts(r):t.ResponseTypes.id_token_token},n.responseTypeForMatchingAccounts=function(e){return s.ScopeSet.containsAnyOidcScopes(e)?t.ResponseTypes.id_token_token:t.ResponseTypes.token},n}();exports.ServerRequestParameters=n;
},{"./utils/CryptoUtils":"Vl5M","./utils/Constants":"kTX3","./utils/StringUtils":"fvWi","./ScopeSet":"gAsY"}],"EdXg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.XhrClient=void 0;var e=require("./utils/Constants"),r=function(){function r(){}return r.prototype.sendRequestAsync=function(r,t,n){var o=this;return new Promise(function(n,s){var u=new XMLHttpRequest;if(u.open(t,r,!0),u.onload=function(){var e;(u.status<200||u.status>=300)&&s(o.handleError(u.responseText));try{e=JSON.parse(u.responseText)}catch(t){s(o.handleError(u.responseText))}var r={statusCode:u.status,body:e};n(r)},u.onerror=function(){s(u.status)},t!==e.NetworkRequestType.GET)throw"not implemented";u.send()})},r.prototype.handleError=function(e){var r;try{if((r=JSON.parse(e)).error)return r.error;throw e}catch(t){return e}},r}();exports.XhrClient=r;
},{"./utils/Constants":"kTX3"}],"qYUX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TrustedAuthority=void 0;var t=o(require("tslib")),e=require("../XHRClient"),r=require("../utils/Constants"),s=require("../utils/UrlUtils");function n(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return n=function(){return t},t}function o(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=n();if(e&&e.has(t))return e.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var i=s?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}var i=function(){function n(){}return n.setTrustedAuthoritiesFromConfig=function(t,e){t&&!this.getTrustedHostList().length&&e.forEach(function(t){n.TrustedHostList.push(t.toLowerCase())})},n.getAliases=function(s,n,o){return t.__awaiter(this,void 0,void 0,function(){var i,u,a,c;return t.__generator(this,function(t){return i=new e.XhrClient,u=r.NetworkRequestType.GET,a=""+r.AAD_INSTANCE_DISCOVERY_ENDPOINT+s+"oauth2/v2.0/authorize",c=n.createAndStartHttpEvent(o,u,a,"getAliases"),[2,i.sendRequestAsync(a,u,!0).then(function(t){return c.httpResponseStatus=t.statusCode,n.stopEvent(c),t.body.metadata}).catch(function(t){throw c.serverErrorCode=t,n.stopEvent(c),t})]})})},n.setTrustedAuthoritiesFromNetwork=function(e,r,o){return t.__awaiter(this,void 0,void 0,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return[4,this.getAliases(e,r,o)];case 1:return t.sent().forEach(function(t){t.aliases.forEach(function(t){n.TrustedHostList.push(t.toLowerCase())})}),i=s.UrlUtils.GetUrlComponents(e).HostNameAndPort,n.getTrustedHostList().length&&!n.IsInTrustedHostList(i)&&n.TrustedHostList.push(i.toLowerCase()),[2]}})})},n.getTrustedHostList=function(){return this.TrustedHostList},n.IsInTrustedHostList=function(t){return this.TrustedHostList.indexOf(t.toLowerCase())>-1},n.TrustedHostList=[],n}();exports.TrustedAuthority=i;
},{"tslib":"vCxL","../XHRClient":"EdXg","../utils/Constants":"kTX3","../utils/UrlUtils":"vR5n"}],"Xp9b":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Authority=exports.AuthorityType=void 0;var t,e=u(require("tslib")),n=require("../error/ClientConfigurationError"),o=require("../XHRClient"),r=require("../utils/UrlUtils"),i=require("./TrustedAuthority"),s=require("../utils/Constants");function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function u(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=o?Object.getOwnPropertyDescriptor(t,r):null;i&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}exports.AuthorityType=t,function(t){t[t.Default=0]="Default",t[t.Adfs=1]="Adfs"}(t||(exports.AuthorityType=t={}));var c=function(){function a(t,e,n){this.IsValidationEnabled=e,this.CanonicalAuthority=t,this.validateAsUri(),this.tenantDiscoveryResponse=n}return a.isAdfs=function(t){var e=r.UrlUtils.GetUrlComponents(t).PathSegments;return e.length&&e[0].toLowerCase()===s.Constants.ADFS},Object.defineProperty(a.prototype,"AuthorityType",{get:function(){return a.isAdfs(this.canonicalAuthority)?t.Adfs:t.Default},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),a.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(a.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(t){this.canonicalAuthority=r.UrlUtils.CanonicalizeUri(t),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=r.UrlUtils.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===t.Adfs?""+this.CanonicalAuthority+s.WELL_KNOWN_SUFFIX:this.CanonicalAuthority+"v2.0/"+s.WELL_KNOWN_SUFFIX},enumerable:!0,configurable:!0}),a.prototype.validateAsUri=function(){var t;try{t=this.CanonicalAuthorityUrlComponents}catch(e){throw n.ClientConfigurationErrorMessage.invalidAuthorityType}if(!t.Protocol||"https:"!==t.Protocol.toLowerCase())throw n.ClientConfigurationErrorMessage.authorityUriInsecure;if(!t.PathSegments||t.PathSegments.length<1)throw n.ClientConfigurationErrorMessage.authorityUriInvalidPath},a.prototype.DiscoverEndpoints=function(t,e,n){var r=new o.XhrClient,i=s.NetworkRequestType.GET,a=e.createAndStartHttpEvent(n,i,t,"openIdConfigurationEndpoint");return r.sendRequestAsync(t,i,!0).then(function(t){return a.httpResponseStatus=t.statusCode,e.stopEvent(a),{AuthorizationEndpoint:t.body.authorization_endpoint,EndSessionEndpoint:t.body.end_session_endpoint,Issuer:t.body.issuer}}).catch(function(t){throw a.serverErrorCode=t,e.stopEvent(a),t})},a.prototype.resolveEndpointsAsync=function(t,o){return e.__awaiter(this,void 0,void 0,function(){var r,s,a;return e.__generator(this,function(e){switch(e.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==i.TrustedAuthority.getTrustedHostList().length?[3,2]:[4,i.TrustedAuthority.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,t,o)]):[3,3];case 1:e.sent(),e.label=2;case 2:if(!i.TrustedAuthority.IsInTrustedHostList(r))throw n.ClientConfigurationError.createUntrustedAuthorityError(r);e.label=3;case 3:return s=this.GetOpenIdConfigurationEndpoint(),a=this,[4,this.DiscoverEndpoints(s,t,o)];case 4:return a.tenantDiscoveryResponse=e.sent(),[2,this.tenantDiscoveryResponse]}})})},a.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},a.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},a}();exports.Authority=c;
},{"tslib":"vCxL","../error/ClientConfigurationError":"c3Oq","../XHRClient":"EdXg","../utils/UrlUtils":"vR5n","./TrustedAuthority":"qYUX","../utils/Constants":"kTX3"}],"ORXc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClientInfo=void 0;var t=require("./utils/CryptoUtils"),i=require("./error/ClientAuthError"),e=require("./utils/StringUtils"),r=function(){function r(n,o){if(!n||e.StringUtils.isEmpty(n))return this.uid="",void(this.utid="");try{var u=t.CryptoUtils.base64Decode(n),s=JSON.parse(u);s&&(s.hasOwnProperty("uid")&&(this.uid=o?r.stripPolicyFromUid(s.uid,o):s.uid),s.hasOwnProperty("utid")&&(this.utid=s.utid))}catch(d){throw i.ClientAuthError.createClientInfoDecodingError(d)}}return Object.defineProperty(r.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(t){this._uid=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(t){this._utid=t},enumerable:!0,configurable:!0}),r.createClientInfoFromIdToken=function(i,e){var n={uid:i.subject,utid:""};return new r(t.CryptoUtils.base64Encode(JSON.stringify(n)),e)},r.stripPolicyFromUid=function(t,i){var r=t.split("-"),n=i.split("/").reverse(),o="";return e.StringUtils.isEmpty(n[0])?n.length>1&&(o=n[1]):o=n[0],r[r.length-1]===o?r.slice(0,r.length-1).join("-"):t},r.prototype.encodeClientInfo=function(){var i=JSON.stringify({uid:this.uid,utid:this.utid});return t.CryptoUtils.base64Encode(i)},r}();exports.ClientInfo=r;
},{"./utils/CryptoUtils":"Vl5M","./error/ClientAuthError":"WdOd","./utils/StringUtils":"fvWi"}],"qVFc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TimeUtils=void 0;var e=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}();exports.TimeUtils=e;
},{}],"hO0O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TokenUtils=void 0;var e=require("./CryptoUtils"),t=require("./StringUtils"),r=require("./TimeUtils"),i=function(){function i(){}return i.decodeJwt=function(e){if(t.StringUtils.isEmpty(e))return null;var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!r||r.length<4?null:{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},i.validateExpirationIsWithinOffset=function(e,t){var i=t||300;return e&&e>r.TimeUtils.now()+i},i.extractIdToken=function(t){var r=this.decodeJwt(t);if(!r)return null;try{var i=r.JWSPayload,n=e.CryptoUtils.base64Decode(i);return n?JSON.parse(n):null}catch(l){}return null},i}();exports.TokenUtils=i;
},{"./CryptoUtils":"Vl5M","./StringUtils":"fvWi","./TimeUtils":"qVFc"}],"ulwF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IdToken=void 0;var s=require("./error/ClientAuthError"),i=require("./utils/TokenUtils"),t=require("./utils/StringUtils"),e=function(){return function(e){if(t.StringUtils.isEmpty(e))throw s.ClientAuthError.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=i.TokenUtils.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(r){throw s.ClientAuthError.createIdTokenParsingError(r)}}}();exports.IdToken=e;
},{"./error/ClientAuthError":"WdOd","./utils/TokenUtils":"hO0O","./utils/StringUtils":"fvWi"}],"Skfa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AccessTokenCacheItem=void 0;var e=function(){return function(e,t){this.key=e,this.value=t}}();exports.AccessTokenCacheItem=e;
},{}],"H9iE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BrowserStorage=void 0;var t=require("../error/ClientConfigurationError"),e=require("../error/AuthError"),o=function(){function o(o){if(!window)throw e.AuthError.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[o]&&null!=window[o]))throw t.ClientConfigurationError.createStorageNotSupportedError(o);this.cacheLocation=o}return o.prototype.setItem=function(t,e,o){window[this.cacheLocation].setItem(t,e),o&&this.setItemCookie(t,e)},o.prototype.getItem=function(t,e){return e&&this.getItemCookie(t)?this.getItemCookie(t):window[this.cacheLocation].getItem(t)},o.prototype.removeItem=function(t){return window[this.cacheLocation].removeItem(t)},o.prototype.clear=function(){return window[this.cacheLocation].clear()},o.prototype.setItemCookie=function(t,e,o){var r=t+"="+e+";path=/;";o&&(r+="expires="+this.getCookieExpirationTime(o)+";");document.cookie=r},o.prototype.getItemCookie=function(t){for(var e=t+"=",o=document.cookie.split(";"),r=0;r<o.length;r++){for(var i=o[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return""},o.prototype.clearItemCookie=function(t){this.setItemCookie(t,"",-1)},o.prototype.getCookieExpirationTime=function(t){var e=new Date;return new Date(e.getTime()+24*t*60*60*1e3).toUTCString()},o}();exports.BrowserStorage=o;
},{"../error/ClientConfigurationError":"c3Oq","../error/AuthError":"Oww8"}],"Keag":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RequestUtils=void 0;var e=l(require("tslib")),t=require("./Constants"),r=require("../error/ClientConfigurationError"),i=require("../ScopeSet"),a=require("./StringUtils"),n=require("./CryptoUtils"),o=require("./TimeUtils"),s=require("../error/ClientAuthError");function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=i?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(r,a,n):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}var c=function(){function u(){}return u.validateRequest=function(t,a,n,o){if(!a&&!t)throw r.ClientConfigurationError.createEmptyRequestError();var s,u;t&&(s=a?i.ScopeSet.appendScopes(t.scopes,t.extraScopesToConsent):t.scopes,i.ScopeSet.validateInputScope(s,!a),s=i.ScopeSet.translateClientIdIfSingleScope(s,n),this.validatePromptParameter(t.prompt),u=this.validateEQParameters(t.extraQueryParameters,t.claimsRequest),this.validateClaimsRequest(t.claimsRequest));var l=this.validateAndGenerateState(t&&t.state,o),c=this.validateAndGenerateCorrelationId(t&&t.correlationId);return e.__assign({},t,{extraQueryParameters:u,scopes:s,state:l,correlationId:c})},u.validatePromptParameter=function(e){if(e&&[t.PromptState.LOGIN,t.PromptState.SELECT_ACCOUNT,t.PromptState.CONSENT,t.PromptState.NONE].indexOf(e)<0)throw r.ClientConfigurationError.createInvalidPromptError(e)},u.validateEQParameters=function(r,i){var a=e.__assign({},r);return a?(i&&delete a[t.Constants.claims],t.BlacklistedEQParams.forEach(function(e){a[e]&&delete a[e]}),a):null},u.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(t){throw r.ClientConfigurationError.createClaimsRequestParsingError(t)}},u.validateAndGenerateState=function(e,r){return a.StringUtils.isEmpty(e)?u.generateLibraryState(r):""+u.generateLibraryState(r)+t.Constants.resourceDelimiter+e},u.generateLibraryState=function(e){var t={id:n.CryptoUtils.createNewGuid(),ts:o.TimeUtils.now(),method:e},r=JSON.stringify(t);return n.CryptoUtils.base64Encode(r)},u.parseLibraryState=function(e){var r=decodeURIComponent(e).split(t.Constants.resourceDelimiter)[0];if(n.CryptoUtils.isGuid(r))return{id:r,ts:o.TimeUtils.now(),method:t.Constants.interactionTypeRedirect};try{var i=n.CryptoUtils.base64Decode(r);return JSON.parse(i)}catch(a){throw s.ClientAuthError.createInvalidStateError(e,null)}},u.validateAndGenerateCorrelationId=function(e){if(e&&!n.CryptoUtils.isGuid(e))throw r.ClientConfigurationError.createInvalidCorrelationIdError();return n.CryptoUtils.isGuid(e)?e:n.CryptoUtils.createNewGuid()},u.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+t.Constants.resourceDelimiter+e.authority},u}();exports.RequestUtils=c;
},{"tslib":"vCxL","./Constants":"kTX3","../error/ClientConfigurationError":"c3Oq","../ScopeSet":"gAsY","./StringUtils":"fvWi","./CryptoUtils":"Vl5M","./TimeUtils":"qVFc","../error/ClientAuthError":"WdOd"}],"mySt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthCache=void 0;var e=c(require("tslib")),t=require("../utils/Constants"),r=require("./AccessTokenCacheItem"),o=require("./BrowserStorage"),a=require("../utils/RequestUtils"),n=require("../utils/StringUtils");function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=o?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(r,a,n):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}var i=function(o){function s(e,t,r){var a=o.call(this,t)||this;return a.clientId=e,a.rollbackEnabled=!0,a.migrateCacheEntries(r),a}return e.__extends(s,o),s.prototype.migrateCacheEntries=function(e){var r=this,a=t.Constants.cachePrefix+"."+t.PersistentCacheKeys.IDTOKEN,n=t.Constants.cachePrefix+"."+t.PersistentCacheKeys.CLIENT_INFO,s=t.Constants.cachePrefix+"."+t.ErrorCacheKeys.ERROR,c=t.Constants.cachePrefix+"."+t.ErrorCacheKeys.ERROR_DESC,i=[o.prototype.getItem.call(this,a),o.prototype.getItem.call(this,n),o.prototype.getItem.call(this,s),o.prototype.getItem.call(this,c)];[t.PersistentCacheKeys.IDTOKEN,t.PersistentCacheKeys.CLIENT_INFO,t.ErrorCacheKeys.ERROR,t.ErrorCacheKeys.ERROR_DESC].forEach(function(t,o){return r.duplicateCacheEntry(t,i[o],e)})},s.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},s.prototype.generateCacheKey=function(e,r){try{return JSON.parse(e),e}catch(o){return 0===e.indexOf(""+t.Constants.cachePrefix)||0===e.indexOf(t.Constants.adalIdToken)?e:r?t.Constants.cachePrefix+"."+this.clientId+"."+e:t.Constants.cachePrefix+"."+e}},s.prototype.matchKeyForType=function(e,r,o,a){var s=n.StringUtils.validateAndParseJsonCacheKey(e);if(!s)return null;var c=e.match(r)&&e.match(o),i=!1;switch(a){case t.ServerHashParamKeys.ACCESS_TOKEN:i=!!e.match(t.Constants.scopes);break;case t.ServerHashParamKeys.ID_TOKEN:i=!e.match(t.Constants.scopes)}return c&&i?s:null},s.prototype.setItem=function(e,t,r){o.prototype.setItem.call(this,this.generateCacheKey(e,!0),t,r),this.rollbackEnabled&&!r&&o.prototype.setItem.call(this,this.generateCacheKey(e,!1),t,r)},s.prototype.getItem=function(e,t){return o.prototype.getItem.call(this,this.generateCacheKey(e,!0),t)},s.prototype.removeItem=function(e){o.prototype.removeItem.call(this,this.generateCacheKey(e,!0)),this.rollbackEnabled&&o.prototype.removeItem.call(this,this.generateCacheKey(e,!1))},s.prototype.resetCacheItems=function(){var e,r=window[this.cacheLocation];for(e in r)r.hasOwnProperty(e)&&-1!==e.indexOf(t.Constants.cachePrefix)&&o.prototype.removeItem.call(this,e)},s.prototype.resetTempCacheItems=function(e){var r=this,n=e&&a.RequestUtils.parseLibraryState(e).id,s=this.tokenRenewalInProgress(e),c=window[this.cacheLocation];n&&!s&&Object.keys(c).forEach(function(e){-1!==e.indexOf(n)&&(r.removeItem(e),o.prototype.clearItemCookie.call(r,e))}),this.removeItem(t.TemporaryCacheKeys.INTERACTION_STATUS),this.removeItem(t.TemporaryCacheKeys.REDIRECT_REQUEST)},s.prototype.setItemCookie=function(e,t,r){o.prototype.setItemCookie.call(this,this.generateCacheKey(e,!0),t,r),this.rollbackEnabled&&o.prototype.setItemCookie.call(this,this.generateCacheKey(e,!1),t,r)},s.prototype.clearItemCookie=function(e){o.prototype.clearItemCookie.call(this,this.generateCacheKey(e,!0)),this.rollbackEnabled&&o.prototype.clearItemCookie.call(this,this.generateCacheKey(e,!1))},s.prototype.getItemCookie=function(e){return o.prototype.getItemCookie.call(this,this.generateCacheKey(e,!0))},s.prototype.getAllTokensByType=function(e,t,o){var a=this;return Object.keys(window[this.cacheLocation]).reduce(function(n,s){var c=a.matchKeyForType(s,e,t,o);if(c){var i=a.getItem(s);if(i)try{var h=new r.AccessTokenCacheItem(c,JSON.parse(i));return n.concat([h])}catch(y){return n}}return n},[])},s.prototype.getAllAccessTokens=function(e,r){return this.getAllTokensByType(e,r,t.ServerHashParamKeys.ACCESS_TOKEN)},s.prototype.getAllIdTokens=function(e,r){return this.getAllTokensByType(e,r,t.ServerHashParamKeys.ID_TOKEN)},s.prototype.getAllTokens=function(e,t){var r=this.getAllAccessTokens(e,t),o=this.getAllIdTokens(e,t);return r.concat(o)},s.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(s.generateTemporaryCacheKey(t.TemporaryCacheKeys.RENEW_STATUS,e));return!(!r||r!==t.Constants.inProgress)},s.prototype.clearMsalCookie=function(e){var r=this;e?(this.clearItemCookie(s.generateTemporaryCacheKey(t.TemporaryCacheKeys.NONCE_IDTOKEN,e)),this.clearItemCookie(s.generateTemporaryCacheKey(t.TemporaryCacheKeys.STATE_LOGIN,e)),this.clearItemCookie(s.generateTemporaryCacheKey(t.TemporaryCacheKeys.LOGIN_REQUEST,e)),this.clearItemCookie(s.generateTemporaryCacheKey(t.TemporaryCacheKeys.STATE_ACQ_TOKEN,e))):document.cookie.split(";").forEach(function(e){var a=e.trim().split("=")[0];a.indexOf(t.Constants.cachePrefix)>-1&&o.prototype.clearItemCookie.call(r,a)})},s.generateAcquireTokenAccountKey=function(e,r){var o=a.RequestUtils.parseLibraryState(r).id;return""+t.TemporaryCacheKeys.ACQUIRE_TOKEN_ACCOUNT+t.Constants.resourceDelimiter+e+t.Constants.resourceDelimiter+o},s.generateAuthorityKey=function(e){return s.generateTemporaryCacheKey(t.TemporaryCacheKeys.AUTHORITY,e)},s.generateTemporaryCacheKey=function(e,r){var o=a.RequestUtils.parseLibraryState(r).id;return""+e+t.Constants.resourceDelimiter+o},s}(o.BrowserStorage);exports.AuthCache=i;
},{"tslib":"vCxL","../utils/Constants":"kTX3","./AccessTokenCacheItem":"Skfa","./BrowserStorage":"H9iE","../utils/RequestUtils":"Keag","../utils/StringUtils":"fvWi"}],"avWH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Account=void 0;var t=require("./utils/CryptoUtils"),e=require("./utils/StringUtils"),i=function(){function i(t,e,i,n,r,o,s){this.accountIdentifier=t,this.homeAccountIdentifier=e,this.userName=i,this.name=n,this.idToken=r,this.idTokenClaims=r,this.sid=o,this.environment=s}return i.createAccount=function(n,r){var o,s=n.objectId||n.subject,c=r?r.uid:"",u=r?r.utid:"";return e.StringUtils.isEmpty(c)||(o=e.StringUtils.isEmpty(u)?t.CryptoUtils.base64Encode(c):t.CryptoUtils.base64Encode(c)+"."+t.CryptoUtils.base64Encode(u)),new i(s,o,n.preferredName,n.name,n.claims,n.sid,n.issuer)},i.compareAccounts=function(t,e){return!(!t||!e)&&!(!t.homeAccountIdentifier||!e.homeAccountIdentifier||t.homeAccountIdentifier!==e.homeAccountIdentifier)},i}();exports.Account=i;
},{"./utils/CryptoUtils":"Vl5M","./utils/StringUtils":"fvWi"}],"ETBp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WindowUtils=void 0;var e=require("../error/ClientAuthError"),r=require("./UrlUtils"),n=require("./Constants"),o=require("./TimeUtils"),t=function(){function t(){}return t.isInIframe=function(){return window.parent!==window},t.isInPopup=function(){return!(!window.opener||window.opener===window)},t.generateFrameName=function(e,r){return""+e+n.Constants.resourceDelimiter+r},t.monitorIframeForHash=function(n,i,a,l){return new Promise(function(s,u){var d=o.TimeUtils.relativeNowMs()+i;l.verbose("monitorWindowForIframe polling started");var c=setInterval(function(){if(o.TimeUtils.relativeNowMs()>d)return l.error("monitorIframeForHash unable to find hash in url, timing out"),l.errorPii("monitorIframeForHash polling timed out for url: "+a),clearInterval(c),void u(e.ClientAuthError.createTokenRenewalTimeoutError());var t;try{t=n.location.href}catch(i){}t&&r.UrlUtils.urlContainsHash(t)&&(l.verbose("monitorIframeForHash found url in hash"),clearInterval(c),s(n.location.hash))},t.POLLING_INTERVAL_MS)})},t.monitorPopupForHash=function(n,o,i,a){return new Promise(function(l,s){var u=o/t.POLLING_INTERVAL_MS,d=0;a.verbose("monitorWindowForHash polling started");var c=setInterval(function(){if(n.closed)return a.error("monitorWindowForHash window closed"),clearInterval(c),void s(e.ClientAuthError.createUserCancelledError());var o;try{o=n.location.href}catch(t){}o&&"about:blank"!==o&&(d++,o&&r.UrlUtils.urlContainsHash(o)?(a.verbose("monitorPopupForHash found url in hash"),clearInterval(c),l(n.location.hash)):d>u&&(a.error("monitorPopupForHash unable to find hash in url, timing out"),a.errorPii("monitorPopupForHash polling timed out for url: "+i),clearInterval(c),s(e.ClientAuthError.createTokenRenewalTimeoutError())))},t.POLLING_INTERVAL_MS)})},t.loadFrame=function(e,r,n,o){var t=this;return o.infoPii("LoadFrame: "+r),new Promise(function(i,a){setTimeout(function(){var n=t.loadFrameSync(e,r,o);n?i(n):a("Unable to load iframe with name: "+r)},n)})},t.loadFrameSync=function(e,r,n){var o=t.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=e,n.infoPii("Frame Name : "+r+" Navigated to: "+e)),o):null},t.addHiddenIFrame=function(e,r){if(void 0===e)return null;r.infoPii("Add msal frame to document:"+e);var n=document.getElementById(e);if(!n){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var o=document.createElement("iframe");o.setAttribute("id",e),o.setAttribute("aria-hidden","true"),o.style.visibility="hidden",o.style.position="absolute",o.style.width=o.style.height="0",o.style.border="0",o.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),n=document.getElementsByTagName("body")[0].appendChild(o)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(n=window.frames[e])}return n},t.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t.getIframeWithHash=function(e){var r=document.getElementsByTagName("iframe");return Array.apply(null,Array(r.length)).map(function(e,n){return r.item(n)}).filter(function(r){try{return r.contentWindow.location.hash===e}catch(n){return!1}})[0]},t.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},t.getPopUpWithHash=function(e){return t.getPopups().filter(function(r){try{return r.location.hash===e}catch(n){return!1}})[0]},t.trackPopup=function(e){t.getPopups().push(e)},t.closePopups=function(){t.getPopups().forEach(function(e){return e.close()})},t.blockReloadInHiddenIframes=function(){if(r.UrlUtils.urlContainsHash(window.location.hash)&&t.isInIframe())throw e.ClientAuthError.createBlockTokenRequestsInHiddenIframeError()},t.checkIfBackButtonIsPressed=function(e){var o=e.getItem(n.TemporaryCacheKeys.REDIRECT_REQUEST);if(o&&!r.UrlUtils.urlContainsHash(window.location.hash)){var t=o.split(n.Constants.resourceDelimiter);t.shift();var i=t.length>0?t.join(n.Constants.resourceDelimiter):null;e.resetTempCacheItems(i)}},t.clearUrlFragment=function(){"function"==typeof history.replaceState?history.replaceState(null,null,""+window.location.pathname+window.location.search):window.location.hash=""},t.POLLING_INTERVAL_MS=50,t}();exports.WindowUtils=t;
},{"../error/ClientAuthError":"WdOd","./UrlUtils":"vR5n","./Constants":"kTX3","./TimeUtils":"qVFc"}],"JA3E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResponseUtils=void 0;var e=r(require("tslib")),n=require("./Constants");function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function r(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=t();if(n&&n.has(e))return n.get(e);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var u=s?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(r,o,u):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}var s=function(){function t(){}return t.setResponseIdToken=function(n,t){if(!n)return null;if(!t)return n;var r=Number(t.expiration);return r&&!n.expiresOn&&(n.expiresOn=new Date(1e3*r)),e.__assign({},n,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},t.buildAuthResponse=function(r,s,o,u,i,a){switch(o.responseType){case n.ResponseTypes.id_token:return s=e.__assign({},s,{tokenType:n.ServerHashParamKeys.ID_TOKEN,account:u,scopes:i,accountState:a}),(s=t.setResponseIdToken(s,r)).idToken?s:null;case n.ResponseTypes.id_token_token:return(s=t.setResponseIdToken(s,r))&&s.accessToken&&s.idToken?s:null;case n.ResponseTypes.token:return s=t.setResponseIdToken(s,r);default:return null}},t}();exports.ResponseUtils=s;
},{"tslib":"vCxL","./Constants":"kTX3"}],"ju1D":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthorityFactory=void 0;var t=a(require("tslib")),e=require("./Authority"),r=require("../utils/StringUtils"),n=require("../error/ClientConfigurationError");function i(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}function a(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=n?Object.getOwnPropertyDescriptor(t,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=t[a]}return r.default=t,e&&e.set(t,r),r}var o=function(){function i(){}return i.saveMetadataFromNetwork=function(e,r,n){return t.__awaiter(this,void 0,void 0,function(){var i;return t.__generator(this,function(t){switch(t.label){case 0:return[4,e.resolveEndpointsAsync(r,n)];case 1:return i=t.sent(),this.metadataMap.set(e.CanonicalAuthority,i),[2,i]}})})},i.getMetadata=function(t){return this.metadataMap.get(t)},i.saveMetadataFromConfig=function(t,e){try{if(e){var r=JSON.parse(e);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw n.ClientConfigurationError.createInvalidAuthorityMetadataError();this.metadataMap.set(t,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(i){throw n.ClientConfigurationError.createInvalidAuthorityMetadataError()}},i.CreateInstance=function(t,n,i){return r.StringUtils.isEmpty(t)?null:(i&&this.saveMetadataFromConfig(t,i),new e.Authority(t,n,this.metadataMap.get(t)))},i.metadataMap=new Map,i}();exports.AuthorityFactory=o;
},{"tslib":"vCxL","./Authority":"Xp9b","../utils/StringUtils":"fvWi","../error/ClientConfigurationError":"c3Oq"}],"R1Sx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=exports.LogLevel=void 0;var o,e=require("./utils/StringUtils"),i=require("./utils/Constants");exports.LogLevel=o,function(o){o[o.Error=0]="Error",o[o.Warning=1]="Warning",o[o.Info=2]="Info",o[o.Verbose=3]="Verbose"}(o||(exports.LogLevel=o={}));var t=function(){function t(e,i){void 0===i&&(i={}),this.level=o.Info;var t=i.correlationId,r=void 0===t?"":t,n=i.level,s=void 0===n?o.Info:n,l=i.piiLoggingEnabled,g=void 0!==l&&l;this.localCallback=e,this.correlationId=r,this.level=s,this.piiLoggingEnabled=g}return t.prototype.logMessage=function(t,r,n){if(!(t>this.level||!this.piiLoggingEnabled&&n)){var s,l=(new Date).toUTCString();s=e.StringUtils.isEmpty(this.correlationId)?l+":"+(0,i.libraryVersion)()+"-"+o[t]+(n?"-pii":"")+" "+r:l+":"+this.correlationId+"-"+(0,i.libraryVersion)()+"-"+o[t]+(n?"-pii":"")+" "+r,this.executeCallback(t,s,n)}},t.prototype.executeCallback=function(o,e,i){this.localCallback&&this.localCallback(o,e,i)},t.prototype.error=function(e){this.logMessage(o.Error,e,!1)},t.prototype.errorPii=function(e){this.logMessage(o.Error,e,!0)},t.prototype.warning=function(e){this.logMessage(o.Warning,e,!1)},t.prototype.warningPii=function(e){this.logMessage(o.Warning,e,!0)},t.prototype.info=function(e){this.logMessage(o.Info,e,!1)},t.prototype.infoPii=function(e){this.logMessage(o.Info,e,!0)},t.prototype.verbose=function(e){this.logMessage(o.Verbose,e,!1)},t.prototype.verbosePii=function(e){this.logMessage(o.Verbose,e,!0)},t.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},t}();exports.Logger=t;
},{"./utils/StringUtils":"fvWi","./utils/Constants":"kTX3"}],"qVCj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildConfiguration=g;var e=o(require("tslib")),t=require("./Logger"),r=require("./utils/UrlUtils");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}var i=6e3,a=300,u=500,s={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return r.UrlUtils.getCurrentUrl()},postLogoutRedirectUri:function(){return r.UrlUtils.getCurrentUrl()},navigateToLoginRequestUrl:!0},l={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},c={logger:new t.Logger(null),loadFrameTimeout:i,tokenRenewalOffsetSeconds:a,navigateFrameWait:u},f={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};function g(t){var r=t.auth,n=t.cache,o=void 0===n?{}:n,i=t.system,a=void 0===i?{}:i,u=t.framework,g=void 0===u?{}:u;return{auth:e.__assign({},s,r),cache:e.__assign({},l,o),system:e.__assign({},c,a),framework:e.__assign({},f,g)}}
},{"tslib":"vCxL","./Logger":"R1Sx","./utils/UrlUtils":"vR5n"}],"MEau":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ServerError=exports.ServerErrorMessage=void 0;var r=n(require("tslib")),e=require("./AuthError");function t(){if("function"!=typeof WeakMap)return null;var r=new WeakMap;return t=function(){return r},r}function n(r){if(r&&r.__esModule)return r;if(null===r||"object"!=typeof r&&"function"!=typeof r)return{default:r};var e=t();if(e&&e.has(r))return e.get(r);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){var u=o?Object.getOwnPropertyDescriptor(r,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=r[a]}return n.default=r,e&&e.set(r,n),n}var o={serverUnavailable:{code:"server_unavailable",desc:"Server is temporarily unavailable."},unknownServerError:{code:"unknown_server_error"}};exports.ServerErrorMessage=o;var a=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return r.__extends(t,e),t.createServerUnavailableError=function(){return new t(o.serverUnavailable.code,o.serverUnavailable.desc)},t.createUnknownServerError=function(r){return new t(o.unknownServerError.code,r)},t}(e.AuthError);exports.ServerError=a;
},{"tslib":"vCxL","./AuthError":"Oww8"}],"kf73":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InteractionRequiredAuthError=exports.InteractionRequiredAuthErrorMessage=void 0;var e=n(require("tslib")),r=require("./ServerError");function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=t();if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}var o={interactionRequired:{code:"interaction_required"},consentRequired:{code:"consent_required"},loginRequired:{code:"login_required"}};exports.InteractionRequiredAuthErrorMessage=o;var i=function(r){function t(e,n){var o=r.call(this,e,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return e.__extends(t,r),t.isInteractionRequiredError=function(e){var r=[o.interactionRequired.code,o.consentRequired.code,o.loginRequired.code];return e&&r.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(o.loginRequired.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(o.interactionRequired.code,e)},t.createConsentRequiredAuthError=function(e){return new t(o.consentRequired.code,e)},t}(r.ServerError);exports.InteractionRequiredAuthError=i;
},{"tslib":"vCxL","./ServerError":"MEau"}],"mHyW":[function(require,module,exports) {
"use strict";function e(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildResponseStateOnly=e;
},{}],"fOZp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TENANT_PLACEHOLDER=exports.TELEMETRY_BLOB_EVENT_NAMES=exports.ELAPSED_TIME_KEY=exports.START_TIME_KEY=exports.EVENT_NAME_KEY=exports.EVENT_NAME_PREFIX=void 0;var t="msal.";exports.EVENT_NAME_PREFIX=t;var e="event_name";exports.EVENT_NAME_KEY=e;var _="start_time";exports.START_TIME_KEY=_;var o="elapsed_time";exports.ELAPSED_TIME_KEY=o;var r={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"};exports.TELEMETRY_BLOB_EVENT_NAMES=r;var s="<tenant>";exports.TENANT_PLACEHOLDER=s;
},{}],"vrUD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.startBrowserPerformanceMeasurement=exports.endBrowserPerformanceMeasurement=exports.supportsBrowserPerformance=exports.prependEventNamePrefix=exports.hashPersonalIdentifier=exports.scrubTenantFromUri=void 0;var r=require("./TelemetryConstants"),e=require("../utils/CryptoUtils"),o=require("../utils/UrlUtils"),n=require("../authority/Authority"),t=function(e){var t=o.UrlUtils.GetUrlComponents(e);if(n.Authority.isAdfs(e))return e;var s=t.PathSegments;if(s&&s.length>=2){var a="tfp"===s[1]?2:1;a<s.length&&(s[a]=r.TENANT_PLACEHOLDER)}return t.Protocol+"//"+t.HostNameAndPort+"/"+s.join("/")};exports.scrubTenantFromUri=t;var s=function(r){return e.CryptoUtils.base64Encode(r)};exports.hashPersonalIdentifier=s;var a=function(e){return""+r.EVENT_NAME_PREFIX+(e||"")};exports.prependEventNamePrefix=a;var i=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)};exports.supportsBrowserPerformance=i;var p=function(r,e,o){i()&&(window.performance.mark(o),window.performance.measure(r,e,o),window.performance.clearMeasures(r),window.performance.clearMarks(e),window.performance.clearMarks(o))};exports.endBrowserPerformanceMeasurement=p;var u=function(r){i()&&window.performance.mark(r)};exports.startBrowserPerformanceMeasurement=u;
},{"./TelemetryConstants":"fOZp","../utils/CryptoUtils":"Vl5M","../utils/UrlUtils":"vR5n","../authority/Authority":"Xp9b"}],"dqr1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("tslib")),t=require("./TelemetryConstants"),r=require("./TelemetryUtils"),n=require("../utils/CryptoUtils");function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}var a=function(){function i(e,i,o){var a;this.eventId=n.CryptoUtils.createNewGuid(),this.label=o,this.event=((a={})[(0,r.prependEventNamePrefix)(t.EVENT_NAME_KEY)]=e,a[(0,r.prependEventNamePrefix)(t.ELAPSED_TIME_KEY)]=-1,a[""+t.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=i,a)}return i.prototype.setElapsedTime=function(e){this.event[(0,r.prependEventNamePrefix)(t.ELAPSED_TIME_KEY)]=e},i.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp),(0,r.endBrowserPerformanceMeasurement)(this.displayName,this.perfStartMark,this.perfEndMark)},i.prototype.start=function(){this.startTimestamp=Date.now(),this.event[(0,r.prependEventNamePrefix)(t.START_TIME_KEY)]=this.startTimestamp,(0,r.startBrowserPerformanceMeasurement)(this.perfStartMark)},Object.defineProperty(i.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+t.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+t.TELEMETRY_BLOB_EVENT_NAMES.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"eventName",{get:function(){return this.event[(0,r.prependEventNamePrefix)(t.EVENT_NAME_KEY)]},enumerable:!0,configurable:!0}),i.prototype.get=function(){return e.__assign({},this.event,{eventId:this.eventId})},Object.defineProperty(i.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),i}(),s=a;exports.default=s;
},{"tslib":"vCxL","./TelemetryConstants":"fOZp","./TelemetryUtils":"vrUD","../utils/CryptoUtils":"Vl5M"}],"Tmbn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("tslib")),t=require("./TelemetryConstants"),n=i(require("./TelemetryEvent")),r=require("./TelemetryUtils");function i(e){return e&&e.__esModule?e:{default:e}}function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}var p=function(n){function i(e,i,o,a){var p=n.call(this,(0,r.prependEventNamePrefix)("default_event"),i,"DefaultEvent")||this;return p.event[(0,r.prependEventNamePrefix)("client_id")]=o,p.event[(0,r.prependEventNamePrefix)("sdk_plaform")]=e.sdk,p.event[(0,r.prependEventNamePrefix)("sdk_version")]=e.sdkVersion,p.event[(0,r.prependEventNamePrefix)("application_name")]=e.applicationName,p.event[(0,r.prependEventNamePrefix)("application_version")]=e.applicationVersion,p.event[(0,r.prependEventNamePrefix)("effective_connection_speed")]=e.networkInformation&&e.networkInformation.connectionSpeed,p.event[""+t.TELEMETRY_BLOB_EVENT_NAMES.UiEventCountTelemetryBatchKey]=p.getEventCount((0,r.prependEventNamePrefix)("ui_event"),a),p.event[""+t.TELEMETRY_BLOB_EVENT_NAMES.HttpEventCountTelemetryBatchKey]=p.getEventCount((0,r.prependEventNamePrefix)("http_event"),a),p.event[""+t.TELEMETRY_BLOB_EVENT_NAMES.CacheEventCountConstStrKey]=p.getEventCount((0,r.prependEventNamePrefix)("cache_event"),a),p}return e.__extends(i,n),i.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},i}(n.default),u=p;exports.default=u;
},{"tslib":"vCxL","./TelemetryConstants":"fOZp","./TelemetryEvent":"dqr1","./TelemetryUtils":"vrUD"}],"FYTE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.API_EVENT_IDENTIFIER=exports.API_CODE=exports.EVENT_KEYS=void 0;var e,t=p(require("tslib")),r=o(require("./TelemetryEvent")),n=require("./TelemetryConstants"),i=require("./TelemetryUtils");function o(e){return e&&e.__esModule?e:{default:e}}function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function p(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=n?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}var c,a,f={AUTHORITY:(0,i.prependEventNamePrefix)("authority"),AUTHORITY_TYPE:(0,i.prependEventNamePrefix)("authority_type"),PROMPT:(0,i.prependEventNamePrefix)("ui_behavior"),TENANT_ID:(0,i.prependEventNamePrefix)("tenant_id"),USER_ID:(0,i.prependEventNamePrefix)("user_id"),WAS_SUCESSFUL:(0,i.prependEventNamePrefix)("was_successful"),API_ERROR_CODE:(0,i.prependEventNamePrefix)("api_error_code"),LOGIN_HINT:(0,i.prependEventNamePrefix)("login_hint")};exports.EVENT_KEYS=f,exports.API_CODE=c,function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(c||(exports.API_CODE=c={})),exports.API_EVENT_IDENTIFIER=a,function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(a||(exports.API_EVENT_IDENTIFIER=a={}));var s=((e={})[a.AcquireTokenSilent]=c.AcquireTokenSilent,e[a.AcquireTokenPopup]=c.AcquireTokenPopup,e[a.AcquireTokenRedirect]=c.AcquireTokenRedirect,e[a.LoginPopup]=c.LoginPopup,e[a.LoginRedirect]=c.LoginRedirect,e[a.Logout]=c.Logout,e),l=function(e){function r(t,r,n){var o=e.call(this,(0,i.prependEventNamePrefix)("api_event"),t,n)||this;return n&&(o.apiCode=s[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return t.__extends(r,e),Object.defineProperty(r.prototype,"apiEventIdentifier",{set:function(e){this.event[n.TELEMETRY_BLOB_EVENT_NAMES.ApiTelemIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"apiCode",{set:function(e){this.event[n.TELEMETRY_BLOB_EVENT_NAMES.ApiIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"authority",{set:function(e){this.event[f.AUTHORITY]=(0,i.scrubTenantFromUri)(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"apiErrorCode",{set:function(e){this.event[f.API_ERROR_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"tenantId",{set:function(e){this.event[f.TENANT_ID]=this.piiEnabled&&e?(0,i.hashPersonalIdentifier)(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"accountId",{set:function(e){this.event[f.USER_ID]=this.piiEnabled&&e?(0,i.hashPersonalIdentifier)(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"wasSuccessful",{get:function(){return!0===this.event[f.WAS_SUCESSFUL]},set:function(e){this.event[f.WAS_SUCESSFUL]=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"loginHint",{set:function(e){this.event[f.LOGIN_HINT]=this.piiEnabled&&e?(0,i.hashPersonalIdentifier)(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"authorityType",{set:function(e){this.event[f.AUTHORITY_TYPE]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"promptType",{set:function(e){this.event[f.PROMPT]=e.toLowerCase()},enumerable:!0,configurable:!0}),r}(r.default),d=l;exports.default=d;
},{"tslib":"vCxL","./TelemetryEvent":"dqr1","./TelemetryConstants":"fOZp","./TelemetryUtils":"vrUD"}],"ggHN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.EVENT_KEYS=void 0;var e=p(require("tslib")),r=o(require("./TelemetryEvent")),t=require("./TelemetryUtils"),n=require("../ServerRequestParameters");function o(e){return e&&e.__esModule?e:{default:e}}function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function p(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=i();if(r&&r.has(e))return r.get(e);var t={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var p=n?Object.getOwnPropertyDescriptor(e,o):null;p&&(p.get||p.set)?Object.defineProperty(t,o,p):t[o]=e[o]}return t.default=e,r&&r.set(e,t),t}var u={HTTP_PATH:(0,t.prependEventNamePrefix)("http_path"),USER_AGENT:(0,t.prependEventNamePrefix)("user_agent"),QUERY_PARAMETERS:(0,t.prependEventNamePrefix)("query_parameters"),API_VERSION:(0,t.prependEventNamePrefix)("api_version"),RESPONSE_CODE:(0,t.prependEventNamePrefix)("response_code"),O_AUTH_ERROR_CODE:(0,t.prependEventNamePrefix)("oauth_error_code"),HTTP_METHOD:(0,t.prependEventNamePrefix)("http_method"),REQUEST_ID_HEADER:(0,t.prependEventNamePrefix)("request_id_header"),SPE_INFO:(0,t.prependEventNamePrefix)("spe_info"),SERVER_ERROR_CODE:(0,t.prependEventNamePrefix)("server_error_code"),SERVER_SUB_ERROR_CODE:(0,t.prependEventNamePrefix)("server_sub_error_code"),URL:(0,t.prependEventNamePrefix)("url")};exports.EVENT_KEYS=u;var a=function(r){function o(e,n){return r.call(this,(0,t.prependEventNamePrefix)("http_event"),e,n)||this}return e.__extends(o,r),Object.defineProperty(o.prototype,"url",{set:function(e){var r=(0,t.scrubTenantFromUri)(e);this.event[u.URL]=r&&r.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"httpPath",{set:function(e){this.event[u.HTTP_PATH]=(0,t.scrubTenantFromUri)(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"userAgent",{set:function(e){this.event[u.USER_AGENT]=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"queryParams",{set:function(e){this.event[u.QUERY_PARAMETERS]=n.ServerRequestParameters.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"apiVersion",{set:function(e){this.event[u.API_VERSION]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"httpResponseStatus",{set:function(e){this.event[u.RESPONSE_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"oAuthErrorCode",{set:function(e){this.event[u.O_AUTH_ERROR_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"httpMethod",{set:function(e){this.event[u.HTTP_METHOD]=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"requestIdHeader",{set:function(e){this.event[u.REQUEST_ID_HEADER]=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"speInfo",{set:function(e){this.event[u.SPE_INFO]=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"serverErrorCode",{set:function(e){this.event[u.SERVER_ERROR_CODE]=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"serverSubErrorCode",{set:function(e){this.event[u.SERVER_SUB_ERROR_CODE]=e},enumerable:!0,configurable:!0}),o}(r.default),f=a;exports.default=f;
},{"tslib":"vCxL","./TelemetryEvent":"dqr1","./TelemetryUtils":"vrUD","../ServerRequestParameters":"VFoY"}],"kip2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("tslib")),t=i(require("./DefaultEvent")),n=require("../utils/Constants"),r=i(require("./ApiEvent")),o=i(require("./HttpEvent"));function i(e){return e&&e.__esModule?e:{default:e}}function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}var l=function(){function i(t,r,o){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=e.__assign({sdk:n.Constants.libraryName,sdkVersion:(0,n.libraryVersion)(),networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},t.platform),this.clientId=t.clientId,this.onlySendFailureTelemetry=t.onlySendFailureTelemetry,this.telemetryEmitter=r,this.logger=o}return i.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},i.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},i.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},i.prototype.flush=function(e){var n=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach(function(e){return n.incrementEventCount(e)});var o=this.completedEvents[e].concat(r);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],o&&o.length){var s=new t.default(this.telemetryPlatform,e,this.clientId,i),a=o.concat([s]);this.telemetryEmitter(a.map(function(e){return e.get()}))}}},i.prototype.createAndStartApiEvent=function(e,t){var n=new r.default(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(n),n},i.prototype.stopAndFlushApiEvent=function(e,t,n,r){t.wasSuccessful=n,r&&(t.apiErrorCode=r),this.stopEvent(t),this.flush(e)},i.prototype.createAndStartHttpEvent=function(e,t,n,r){var i=new o.default(e,r);return i.url=n,i.httpMethod=t,this.startEvent(i),i},i.prototype.incrementEventCount=function(e){var t,n=e.eventName,r=this.eventCountByCorrelationId[e.telemetryCorrelationId];r?r[n]=r[n]?r[n]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[n]=1,t)},i.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(n,r){if(-1!==r.indexOf(e)){var o=t.inProgressEvents[r];return delete t.inProgressEvents[r],n.concat([o])}return n},[])},i}(),u=l;exports.default=u;
},{"tslib":"vCxL","./DefaultEvent":"Tmbn","../utils/Constants":"kTX3","./ApiEvent":"FYTE","./HttpEvent":"ggHN"}],"eEzW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AuthCacheUtils=void 0;var e=require("../ScopeSet"),t=require("./UrlUtils"),r=function(){function r(){}return r.filterTokenCacheItemsByScope=function(t,r){return t.filter(function(t){var n=t.key.scopes.split(" "),o=e.ScopeSet.removeDefaultScopes(r);return 0===o.length?e.ScopeSet.containsScope(n,r):e.ScopeSet.containsScope(n,o)})},r.filterTokenCacheItemsByAuthority=function(e,r){return e.filter(function(e){return t.UrlUtils.CanonicalizeUri(e.key.authority)===r})},r.filterTokenCacheItemsByDomain=function(e,r){return e.filter(function(e){return t.UrlUtils.GetUrlComponents(e.key.authority).HostNameAndPort===r})},r}();exports.AuthCacheUtils=r;
},{"../ScopeSet":"gAsY","./UrlUtils":"vR5n"}],"uwyl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UserAgentApplication=void 0;var e=O(require("tslib")),t=require("./cache/AccessTokenKey"),r=require("./cache/AccessTokenValue"),o=require("./ServerRequestParameters"),s=require("./authority/Authority"),n=require("./ClientInfo"),i=require("./IdToken"),a=require("./cache/AuthCache"),c=require("./Account"),h=require("./ScopeSet"),l=require("./utils/StringUtils"),u=require("./utils/WindowUtils"),g=require("./utils/TokenUtils"),p=require("./utils/TimeUtils"),d=require("./utils/UrlUtils"),y=require("./utils/RequestUtils"),v=require("./utils/ResponseUtils"),f=require("./authority/AuthorityFactory"),m=require("./Configuration"),T=require("./error/ClientConfigurationError"),C=require("./error/AuthError"),I=require("./error/ClientAuthError"),S=require("./error/ServerError"),A=require("./error/InteractionRequiredAuthError"),w=require("./AuthResponse"),k=q(require("./telemetry/TelemetryManager")),b=require("./telemetry/ApiEvent"),E=require("./utils/Constants"),R=require("./utils/CryptoUtils"),U=require("./authority/TrustedAuthority"),P=require("./utils/AuthCacheUtils");function q(e){return e&&e.__esModule?e:{default:e}}function N(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return N=function(){return e},e}function O(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=N();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var n=o?Object.getOwnPropertyDescriptor(e,s):null;n&&(n.get||n.set)?Object.defineProperty(r,s,n):r[s]=e[s]}return r.default=e,t&&t.set(e,r),r}var K="https://login.microsoftonline.com/common",_=function(){function q(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(0,m.buildConfiguration)(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),U.TrustedAuthority.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),f.AuthorityFactory.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||K,this.cacheStorage=new a.AuthCache(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=d.UrlUtils.urlContainsHash(t);(u.WindowUtils.checkIfBackButtonIsPressed(this.cacheStorage),r)&&(this.getResponseState(t).method===E.Constants.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(q.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=f.AuthorityFactory.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),q.prototype.getAuthorityInstance=function(){return this.authorityInstance},q.prototype.handleRedirectCallback=function(e,t){if(!e)throw T.ClientConfigurationError.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(E.Constants.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(E.Constants.interactionTypeRedirect,this.redirectResponse)},q.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),d.UrlUtils.urlContainsHash(e)},q.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),e===E.Constants.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==E.Constants.interactionTypePopup)throw I.ClientAuthError.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},q.prototype.authErrorHandler=function(e,t,r,o){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(E.TemporaryCacheKeys.INTERACTION_STATUS),e===E.Constants.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==E.Constants.interactionTypePopup)throw I.ClientAuthError.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),o(t)}},q.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=y.RequestUtils.validateRequest(e,!0,this.clientId,E.Constants.interactionTypeRedirect);this.acquireTokenInteractive(E.Constants.interactionTypeRedirect,!0,t,null,null)},q.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=y.RequestUtils.validateRequest(e,!1,this.clientId,E.Constants.interactionTypeRedirect);this.acquireTokenInteractive(E.Constants.interactionTypeRedirect,!1,t,null,null)},q.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=y.RequestUtils.validateRequest(e,!0,this.clientId,E.Constants.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,b.API_EVENT_IDENTIFIER.LoginPopup);return new Promise(function(e,o){t.acquireTokenInteractive(E.Constants.interactionTypePopup,!0,r,e,o)}).then(function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e})},q.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=y.RequestUtils.validateRequest(e,!1,this.clientId,E.Constants.interactionTypePopup),o=this.telemetryManager.createAndStartApiEvent(r.correlationId,b.API_EVENT_IDENTIFIER.AcquireTokenPopup);return new Promise(function(e,o){t.acquireTokenInteractive(E.Constants.interactionTypePopup,!1,r,e,o)}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,o,!1,e.errorCode),e})},q.prototype.acquireTokenInteractive=function(e,t,r,s,n){var i=this;this.logger.verbose("AcquireTokenInteractive has been called"),u.WindowUtils.blockReloadInHiddenIframes();var a,c=this.cacheStorage.getItem(E.TemporaryCacheKeys.INTERACTION_STATUS);if(e===E.Constants.interactionTypeRedirect&&this.cacheStorage.setItem(E.TemporaryCacheKeys.REDIRECT_REQUEST,""+E.Constants.inProgress+E.Constants.resourceDelimiter+r.state),c===E.Constants.inProgress){var h=t?I.ClientAuthError.createLoginInProgressError():I.ClientAuthError.createAcquireTokenInProgressError(),l=(0,w.buildResponseStateOnly)(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,h,l,n)}if(r&&r.account&&!t?(a=r.account,this.logger.verbose("Account set from request")):(a=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a||o.ServerRequestParameters.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(a,e,t,r,s,n);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");l=(0,w.buildResponseStateOnly)(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,I.ClientAuthError.createUserLoginRequiredError(),l,n)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var g=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(g).then(function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,s)},function(o){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+o),i.acquireTokenHelper(null,e,t,r,s,n)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,s,n)}},q.prototype.acquireTokenHelper=function(t,r,s,n,i,c){return e.__awaiter(this,void 0,void 0,function(){var h,l,g,p,y,v,m,T,C,S;return e.__generator(this,function(e){switch(e.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+r+". isLoginCall: "+s),this.cacheStorage.setItem(E.TemporaryCacheKeys.INTERACTION_STATUS,E.Constants.inProgress),h=n.scopes?n.scopes.join(" ").toLowerCase():E.Constants.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+h),g=n&&n.authority?f.AuthorityFactory.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,e.label=1;case 1:return e.trys.push([1,11,,12]),g.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,f.AuthorityFactory.saveMetadataFromNetwork(g,this.telemetryManager,n.correlationId)]);case 2:return e.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),e.label=4;case 4:if(y=s?E.ResponseTypes.id_token:this.getTokenType(t,n.scopes),v=n.redirectStartPage||window.location.href,l=new o.ServerRequestParameters(g,this.clientId,y,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(l,t,s,v),this.logger.verbose("Updating cache entries"),l.populateQueryParams(t,n),this.logger.verbose("Query parameters populated from account"),m=d.UrlUtils.createNavigateUrl(l)+E.Constants.response_mode_fragment,r===E.Constants.interactionTypeRedirect)s?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.STATE_ACQ_TOKEN,n.state),l.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+l.state));else{if(r!==E.Constants.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),I.ClientAuthError.createInvalidInteractionTypeError();window.renewStates.push(l.state),window.requestType=s?E.Constants.login:E.Constants.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+l.state),this.registerCallback(l.state,h,i,c)}if(r!==E.Constants.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{p=this.openPopup(m,"msal",E.Constants.popUpWidth,E.Constants.popUpHeight),u.WindowUtils.trackPopup(p)}catch(A){if(this.logger.info(I.ClientAuthErrorMessage.popUpWindowError.code+":"+I.ClientAuthErrorMessage.popUpWindowError.desc),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR,I.ClientAuthErrorMessage.popUpWindowError.code),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR_DESC,I.ClientAuthErrorMessage.popUpWindowError.desc),c)return c(I.ClientAuthError.createPopupWindowError()),[2]}if(!p)return[3,8];e.label=5;case 5:return e.trys.push([5,7,,8]),[4,u.WindowUtils.monitorPopupForHash(p,this.config.system.loadFrameTimeout,m,this.logger)];case 6:return T=e.sent(),this.handleAuthenticationResponse(T),this.cacheStorage.removeItem(E.TemporaryCacheKeys.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",T),u.WindowUtils.closePopups(),[3,8];case 7:return C=e.sent(),c&&c(C),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",C.errorCode+E.Constants.resourceDelimiter+C.errorMessage):(this.cacheStorage.removeItem(E.TemporaryCacheKeys.INTERACTION_STATUS),p.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==n.onRedirectNavigate(m)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(m)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(m)),e.label=10;case 10:return[3,12];case 11:return S=e.sent(),this.logger.error(S),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(r,I.ClientAuthError.createEndpointResolutionError(S.toString),(0,w.buildResponseStateOnly)(n.state),c),p&&p.close(),[3,12];case 12:return[2]}})})},q.prototype.ssoSilent=function(t){if(this.logger.verbose("ssoSilent has been called"),!t)throw T.ClientConfigurationError.createEmptyRequestError();if(!t.sid&&!t.loginHint)throw T.ClientConfigurationError.createSsoSilentError();return this.acquireTokenSilent(e.__assign({},t,{scopes:E.Constants.oidcScopes}))},q.prototype.acquireTokenSilent=function(t){var r=this;this.logger.verbose("AcquireTokenSilent has been called");var s=y.RequestUtils.validateRequest(t,!1,this.clientId,E.Constants.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(s.correlationId,b.API_EVENT_IDENTIFIER.AcquireTokenSilent),i=y.RequestUtils.createRequestSignature(s);return new Promise(function(t,n){return e.__awaiter(r,void 0,void 0,function(){var r,a,c,p,d,y,v,m,T,C,S;return e.__generator(this,function(e){switch(e.label){case 0:if(u.WindowUtils.blockReloadInHiddenIframes(),r=s.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+r),s.account?(a=s.account,this.logger.verbose("Account set from request")):(a=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),c=this.cacheStorage.getItem(E.Constants.adalIdToken),!a&&!s.sid&&!s.loginHint&&l.StringUtils.isEmpty(c))return this.logger.info("User login is required"),[2,n(I.ClientAuthError.createUserLoginRequiredError())];if(p=this.getTokenType(a,s.scopes),this.logger.verbose("Response type: "+p),d=new o.ServerRequestParameters(f.AuthorityFactory.CreateInstance(s.authority,this.config.auth.validateAuthority,s.authorityMetadata),this.clientId,p,this.getRedirectUri(s.redirectUri),s.scopes,s.state,s.correlationId),this.logger.verbose("Finished building server authentication request"),o.ServerRequestParameters.isSSOParam(s)||a?(d.populateQueryParams(a,s,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):a||l.StringUtils.isEmpty(c)?this.logger.verbose("No additional query parameters added"):(y=g.TokenUtils.extractIdToken(c),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),d.populateQueryParams(a,null,y,!0)),!(v=s.claimsRequest||d.claimsValue)&&!s.forceRefresh)try{T=this.getCachedToken(d,a)}catch(A){m=A}return T?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(T.scopes)),t(T),[2,null]):[3,1];case 1:return m?(this.logger.infoPii(m.errorCode+":"+m.errorMessage),n(m),[2,null]):[3,2];case 2:C=void 0,C=v?"Skipped cache lookup since claims were given":s.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(C),d.authorityInstance||(d.authorityInstance=s.authority?f.AuthorityFactory.CreateInstance(s.authority,this.config.auth.validateAuthority,s.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+d.authority),e.label=3;case 3:return e.trys.push([3,7,,8]),d.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,f.AuthorityFactory.saveMetadataFromNetwork(d.authorityInstance,this.telemetryManager,s.correlationId)]);case 4:return e.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),e.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,t,n)):s.scopes&&h.ScopeSet.onlyContainsOidcScopes(s.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,t,n,a,d)):(this.logger.verbose("Renewing access token"),this.renewToken(i,t,n,a,d)),[3,8];case 7:return S=e.sent(),this.logger.error(S),n(I.ClientAuthError.createEndpointResolutionError(S.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return r.logger.verbose("Successfully acquired token"),r.telemetryManager.stopAndFlushApiEvent(s.correlationId,n,!0),e}).catch(function(e){throw r.cacheStorage.resetTempCacheItems(s.state),r.telemetryManager.stopAndFlushApiEvent(s.correlationId,n,!1,e.errorCode),e})},q.prototype.openPopup=function(e,t,r,o){this.logger.verbose("OpenPopup has been called");try{var s=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=i/2-r/2+s,h=a/2-o/2+n,l=window.open(e,t,"width="+r+", height="+o+", top="+h+", left="+c+", scrollbars=yes");if(!l)throw I.ClientAuthError.createPopupWindowError();return l.focus&&l.focus(),l}catch(u){throw this.cacheStorage.removeItem(E.TemporaryCacheKeys.INTERACTION_STATUS),I.ClientAuthError.createPopupWindowError(u.toString())}},q.prototype.loadIframeTimeout=function(t,r,o){return e.__awaiter(this,void 0,void 0,function(){var s,n,i,c,h;return e.__generator(this,function(e){switch(e.label){case 0:return s=window.activeRenewals[o],this.logger.verbosePii("Set loading state to pending for: "+o+":"+s),this.cacheStorage.setItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.RENEW_STATUS,s),E.Constants.inProgress),this.config.system.navigateFrameWait?[4,u.WindowUtils.loadFrame(t,r,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return i=e.sent(),[3,3];case 2:i=u.WindowUtils.loadFrameSync(t,r,this.logger),e.label=3;case 3:n=i,e.label=4;case 4:return e.trys.push([4,6,,7]),[4,u.WindowUtils.monitorIframeForHash(n.contentWindow,this.config.system.loadFrameTimeout,t,this.logger)];case 5:return(c=e.sent())&&this.handleAuthenticationResponse(c),[3,7];case 6:throw h=e.sent(),this.cacheStorage.getItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.RENEW_STATUS,s))===E.Constants.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+o+":"+s),s&&window.callbackMappedToRenewStates[s]&&window.callbackMappedToRenewStates[s](null,h),this.cacheStorage.removeItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.RENEW_STATUS,s))),u.WindowUtils.removeHiddenIframe(n),h;case 7:return u.WindowUtils.removeHiddenIframe(n),[2]}})})},q.prototype.navigateWindow=function(e,t){if(!e||l.StringUtils.isEmpty(e))throw this.logger.info("Navigate url is empty"),C.AuthError.createUnexpectedError("Navigate url is empty");var r=t||window,o=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(o),r.location.assign(e)},q.prototype.registerCallback=function(e,t,r,o){var s=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:o}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,o){window.activeRenewals[t]=null;for(var n=0;n<window.promiseMappedToRenewStates[e].length;++n)try{if(o)window.promiseMappedToRenewStates[e][n].reject(o);else{if(!r)throw s.cacheStorage.resetTempCacheItems(e),C.AuthError.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][n].resolve(r)}}catch(i){s.logger.warning(i)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},q.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},q.prototype.logoutAsync=function(t){return e.__awaiter(this,void 0,void 0,function(){var r,o,s,n,i,a;return e.__generator(this,function(e){switch(e.label){case 0:r=t||R.CryptoUtils.createNewGuid(),o=this.telemetryManager.createAndStartApiEvent(r,b.API_EVENT_IDENTIFIER.Logout),this.clearCache(),this.account=null,e.label=1;case 1:return e.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,f.AuthorityFactory.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,t)]);case 2:return e.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),e.label=4;case 4:return s="client-request-id="+r,n=void 0,this.getPostLogoutRedirectUri()?(n="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(n="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+s+n,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+s+n,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(r,o,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return a=e.sent(),this.telemetryManager.stopAndFlushApiEvent(r,o,!1,a.errorCode),[3,6];case 6:return[2]}})})},q.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(E.Constants.clientId,E.Constants.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},q.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(E.Constants.clientId,E.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var o=t[r];o.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(o.key)),this.logger.verbosePii("Access token removed: "+o.key))}},q.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),d.UrlUtils.urlContainsHash(e)},q.prototype.processCallBack=function(e,t,r){var o,s;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{o=this.saveTokenFromHash(e,t)}catch(i){s=i}try{this.cacheStorage.clearMsalCookie(t.state);var n=this.getAccountState(t.state);if(o){if(t.requestType===E.Constants.renewToken||o.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+E.ServerHashParamKeys.ACCESS_TOKEN),o.tokenType=E.ServerHashParamKeys.ACCESS_TOKEN):t.requestType===E.Constants.login&&(this.logger.verbose("Response tokenType set to "+E.ServerHashParamKeys.ID_TOKEN),o.tokenType=E.ServerHashParamKeys.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=o)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=(0,w.buildResponseStateOnly)(n),this.redirectError=s,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),r(o,s)}catch(i){throw this.logger.error("Error occurred in token received callback function: "+i),I.ClientAuthError.createErrorInCallbackFunction(i.toString())}},q.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var o=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,o)},q.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),u.WindowUtils.clearUrlFragment(),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var o=d.UrlUtils.removeHashFromUrl(window.location.href),s=d.UrlUtils.removeHashFromUrl(r);if(o!==s)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+o+", finalRedirectUrl: "+s),void window.location.assign(""+s+e);this.logger.verbose("Current url matches login request url");var n=d.UrlUtils.GetUrlComponents(r);n.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=n.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},q.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=d.UrlUtils.deserializeHash(e);if(!r)throw C.AuthError.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(E.ServerHashParamKeys.STATE))throw C.AuthError.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var o=y.RequestUtils.parseLibraryState(r.state);if((t={requestType:E.Constants.unknown,state:r.state,timestamp:o.ts,method:o.method,stateMatch:!1}).state===this.cacheStorage.getItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=E.Constants.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=E.Constants.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var s=window.renewStates,n=0;n<s.length;n++)if(s[n]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},q.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,o=this.getCachedIdToken(e,t),s=this.getCachedAccessToken(e,t,r),n=this.getAccountState(e.state);return v.ResponseUtils.buildAuthResponse(o,s,e,t,r,n)},q.prototype.getTokenCacheItemByAuthority=function(e,t,r,o){var s,n=this;return 1===(s=d.UrlUtils.isCommonAuthority(e)||d.UrlUtils.isOrganizationsAuthority(e)?P.AuthCacheUtils.filterTokenCacheItemsByDomain(t,d.UrlUtils.GetUrlComponents(e).HostNameAndPort):P.AuthCacheUtils.filterTokenCacheItemsByAuthority(t,e)).length?s[0]:s.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),s.forEach(function(e){n.cacheStorage.removeItem(JSON.stringify(e.key))}),null):(this.logger.verbose("No matching tokens of type "+o+" found"),null)},q.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),o=e.authority||this.authority,s=this.getTokenCacheItemByAuthority(o,r,null,E.ServerHashParamKeys.ID_TOKEN);if(s){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(s)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var n=s.value;return n?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),n?new i.IdToken(n.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(s.key)),null}return this.logger.verbose("No tokens found"),null},q.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),s=P.AuthCacheUtils.filterTokenCacheItemsByScope(o,r),n=e.authority||this.authority,i=this.getTokenCacheItemByAuthority(n,s,r,E.ServerHashParamKeys.ACCESS_TOKEN);if(i){if(e.authorityInstance=f.AuthorityFactory.CreateInstance(i.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(i)){if(this.logger.verbose("Access token expiration is within offset, using access token found in cache"),!t&&!(t=this.getAccount()))throw C.AuthError.createUnexpectedError("Account should not be null here.");var a=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:E.ServerHashParamKeys.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:i.value.accessToken,scopes:i.key.scopes.split(" "),expiresOn:new Date(1e3*Number(i.value.expiresIn)),account:t,accountState:a,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(i.key)),null}this.logger.verbose("No matching token found when filtering by scope and authority");var c=this.getUniqueAuthority(o,"authority");if(c.length>1)throw I.ClientAuthError.createMultipleAuthoritiesInCacheError(r.toString());return this.logger.verbose("Single authority used, setting authorityInstance"),e.authorityInstance=f.AuthorityFactory.CreateInstance(c[0],this.config.auth.validateAuthority),null},q.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return g.TokenUtils.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},q.prototype.getUniqueAuthority=function(e,t){this.logger.verbose("GetUniqueAuthority has been called");var r=[],o=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===o.indexOf(e.key[t])&&(o.push(e.key[t]),r.push(e.key[t]))}),r},q.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(E.Constants.adalIdToken);return l.StringUtils.isEmpty(e)?null:g.TokenUtils.extractIdToken(e)},q.prototype.renewToken=function(e,t,r,o,s){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var n=u.WindowUtils.generateFrameName(E.FramePrefix.TOKEN_FRAME,e);u.WindowUtils.addHiddenIFrame(n,this.logger),this.updateCacheEntries(s,o,!1),this.logger.verbosePii("RenewToken expected state: "+s.state);var i=d.UrlUtils.urlRemoveQueryStringParameter(d.UrlUtils.createNavigateUrl(s),E.Constants.prompt)+E.Constants.prompt_none+E.Constants.response_mode_fragment;window.renewStates.push(s.state),window.requestType=E.Constants.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(s.state,e,t,r),this.logger.infoPii("Navigate to: "+i),this.loadIframeTimeout(i,n,e).catch(function(e){return r(e)})},q.prototype.renewIdToken=function(e,t,r,o,s){this.logger.info("RenewIdToken has been called");var n=u.WindowUtils.generateFrameName(E.FramePrefix.ID_TOKEN_FRAME,e);u.WindowUtils.addHiddenIFrame(n,this.logger),this.updateCacheEntries(s,o,!1),this.logger.verbose("RenewIdToken expected state: "+s.state);var i=d.UrlUtils.urlRemoveQueryStringParameter(d.UrlUtils.createNavigateUrl(s),E.Constants.prompt)+E.Constants.prompt_none+E.Constants.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=E.Constants.login,this.silentAuthenticationState=s.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=E.Constants.renewToken,window.renewStates.push(s.state)),this.registerCallback(s.state,e,t,r),this.logger.infoPii('Navigate to:" '+i),this.loadIframeTimeout(i,n,e).catch(function(e){return r(e)})},q.prototype.saveToken=function(e,o,s,n,i){var a=new t.AccessTokenKey(o,this.clientId,s,n.uid,n.utid),c=new r.AccessTokenValue(e.accessToken,e.idToken.rawIdToken,i.toString(),n.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(a),JSON.stringify(c)),i?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*i)):this.logger.error("Could not parse expiresIn parameter for access token"),e},q.prototype.saveIdToken=function(t,r,o,s,n){this.logger.verbose("SaveIdToken has been called");var i=e.__assign({},t);i.scopes=E.Constants.oidcScopes,i.accessToken=o[E.ServerHashParamKeys.ID_TOKEN];var a=Number(n.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(i,r,void 0,s,a)},q.prototype.saveAccessToken=function(t,r,o,s){this.logger.verbose("SaveAccessToken has been called");var n=e.__assign({},t),i=o[E.ServerHashParamKeys.SCOPE],a=i.split(" "),c=this.cacheStorage.getAllAccessTokens(this.clientId,r);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var l=0;l<c.length;l++){var u=c[l];if(u.key.homeAccountIdentifier===t.account.homeAccountIdentifier){var g=u.key.scopes.split(" ");h.ScopeSet.isIntersectingScopes(g,a)&&this.cacheStorage.removeItem(JSON.stringify(u.key))}}n.accessToken=o[E.ServerHashParamKeys.ACCESS_TOKEN],n.scopes=a;var d=p.TimeUtils.parseExpiresIn(o[E.ServerHashParamKeys.EXPIRES_IN]),v=y.RequestUtils.parseLibraryState(o[E.ServerHashParamKeys.STATE]).ts+d;return this.logger.verbose("Saving access token to cache"),this.saveToken(n,r,i,s,v)},q.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,o={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},h=d.UrlUtils.deserializeHash(e),u="",g="",p=null;if(h.hasOwnProperty(E.ServerHashParamKeys.ERROR_DESCRIPTION)||h.hasOwnProperty(E.ServerHashParamKeys.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+h[E.ServerHashParamKeys.ERROR]+"; Error description: "+h[E.ServerHashParamKeys.ERROR_DESCRIPTION]),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR,h[E.ServerHashParamKeys.ERROR]),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR_DESC,h[E.ServerHashParamKeys.ERROR_DESCRIPTION]),t.requestType===E.Constants.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(E.ErrorCacheKeys.LOGIN_ERROR,h[E.ServerHashParamKeys.ERROR_DESCRIPTION]+":"+h[E.ServerHashParamKeys.ERROR]),u=a.AuthCache.generateAuthorityKey(t.state)),t.requestType===E.Constants.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),u=a.AuthCache.generateAuthorityKey(t.state);var y=this.getAccount(),f=void 0;y&&!l.StringUtils.isEmpty(y.homeAccountIdentifier)?(f=y.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(f=E.Constants.no_account,this.logger.verbose("AccountId is set as no_account")),g=a.AuthCache.generateAcquireTokenAccountKey(f,t.state)}var m=h[E.ServerHashParamKeys.ERROR],T=h[E.ServerHashParamKeys.ERROR_DESCRIPTION];r=A.InteractionRequiredAuthError.isInteractionRequiredError(m)||A.InteractionRequiredAuthError.isInteractionRequiredError(T)?new A.InteractionRequiredAuthError(h[E.ServerHashParamKeys.ERROR],h[E.ServerHashParamKeys.ERROR_DESCRIPTION]):new S.ServerError(h[E.ServerHashParamKeys.ERROR],h[E.ServerHashParamKeys.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),h.hasOwnProperty(E.ServerHashParamKeys.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.SESSION_STATE,t.state),h[E.ServerHashParamKeys.SESSION_STATE])),o.accountState=this.getAccountState(t.state);var w=void 0;if(h.hasOwnProperty(E.ServerHashParamKeys.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),o.accessToken=h[E.ServerHashParamKeys.ACCESS_TOKEN],h.hasOwnProperty(E.ServerHashParamKeys.SCOPE)&&(o.scopes=h[E.ServerHashParamKeys.SCOPE].split(" ")),h.hasOwnProperty(E.ServerHashParamKeys.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),p=new i.IdToken(h[E.ServerHashParamKeys.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),p=new i.IdToken(this.cacheStorage.getItem(E.PersistentCacheKeys.IDTOKEN))),o=v.ResponseUtils.setResponseIdToken(o,p);var k=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,p);this.logger.verbose("Got authority from cache"),h.hasOwnProperty(E.ServerHashParamKeys.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),w=new n.ClientInfo(h[E.ServerHashParamKeys.CLIENT_INFO],k)):this.authorityInstance.AuthorityType===s.AuthorityType.Adfs?w=n.ClientInfo.createClientInfoFromIdToken(p,k):this.logger.warning("ClientInfo not received in the response from AAD"),o.account=c.Account.createAccount(p,w),this.logger.verbose("Account object created from response");var b=void 0;o.account&&!l.StringUtils.isEmpty(o.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),b=o.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),b=E.Constants.no_account),g=a.AuthCache.generateAcquireTokenAccountKey(b,t.state);var R=a.AuthCache.generateAcquireTokenAccountKey(E.Constants.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var U=this.cacheStorage.getItem(g),P=void 0;l.StringUtils.isEmpty(U)?l.StringUtils.isEmpty(this.cacheStorage.getItem(R))||(this.logger.verbose("No acquireToken account retrieved from cache"),o=this.saveAccessToken(o,k,h,w)):(P=JSON.parse(U),this.logger.verbose("AcquireToken request account retrieved from cache"),o.account&&P&&c.Account.compareAccounts(o.account,P)?(o=this.saveAccessToken(o,k,h,w),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(h.hasOwnProperty(E.ServerHashParamKeys.ID_TOKEN)){this.logger.info("Fragment has idToken"),p=new i.IdToken(h[E.ServerHashParamKeys.ID_TOKEN]);k=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,p);if(o=v.ResponseUtils.setResponseIdToken(o,p),h.hasOwnProperty(E.ServerHashParamKeys.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),w=new n.ClientInfo(h[E.ServerHashParamKeys.CLIENT_INFO],k)):this.authorityInstance.AuthorityType===s.AuthorityType.Adfs?w=n.ClientInfo.createClientInfoFromIdToken(p,k):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=c.Account.createAccount(p,w),o.account=this.account,this.logger.verbose("Account object created from response"),p&&p.nonce){this.logger.verbose("IdToken has nonce");var q=this.cacheStorage.getItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.NONCE_IDTOKEN,t.state),this.inCookie);p.nonce!==q?(this.account=null,this.cacheStorage.setItem(E.ErrorCacheKeys.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+q+",Actual Nonce: "+p.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+q+", Actual Nonce: "+p.nonce),r=I.ClientAuthError.createNonceMismatchError(q,p.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(E.PersistentCacheKeys.IDTOKEN,h[E.ServerHashParamKeys.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(E.PersistentCacheKeys.CLIENT_INFO,w.encodeClientInfo(),this.inCookie),this.saveIdToken(o,k,h,w,p))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),u=t.state,g=t.state,this.logger.error("Invalid id_token received in the response"),r=I.ClientAuthError.createInvalidIdTokenError(p),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR_DESC,r.errorMessage)}}else{this.logger.verbose("State mismatch"),u=t.state,g=t.state;var N=this.cacheStorage.getItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+N+", Actual State: "+t.state),r=I.ClientAuthError.createInvalidStateError(t.state,N),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR,r.errorCode),this.cacheStorage.setItem(E.ErrorCacheKeys.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(u,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!o)throw C.AuthError.createUnexpectedError("Response is null");return o},q.prototype.populateAuthority=function(e,t,r,o){this.logger.verbose("PopulateAuthority has been called");var s=a.AuthCache.generateAuthorityKey(e),n=r.getItem(s,t);return l.StringUtils.isEmpty(n)?n:d.UrlUtils.replaceTenantPath(n,o.tenantId)},q.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(E.PersistentCacheKeys.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(E.PersistentCacheKeys.CLIENT_INFO,this.inCookie);if(!l.StringUtils.isEmpty(e)&&!l.StringUtils.isEmpty(t)){var r=new i.IdToken(e),o=new n.ClientInfo(t,"");return this.account=c.Account.createAccount(r,o),this.account}return null},q.prototype.getAccountState=function(e){if(e){var t=e.indexOf(E.Constants.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},q.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(E.Constants.clientId,E.Constants.homeAccountIdentifier),r=0;r<t.length;r++){var o=new i.IdToken(t[r].value.idToken),s=new n.ClientInfo(t[r].value.homeAccountIdentifier,""),a=c.Account.createAccount(o,s);e.push(a)}return this.getUniqueAccounts(e)},q.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],o=0;o<e.length;++o)e[o].homeAccountIdentifier&&-1===t.indexOf(e[o].homeAccountIdentifier)&&(t.push(e[o].homeAccountIdentifier),r.push(e[o]));return r},q.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},q.prototype.getCachedTokenInternal=function(e,t,r,s){var n=t||this.getAccount();if(!n)return null;var i=this.authorityInstance?this.authorityInstance:f.AuthorityFactory.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(n,e),c=new o.ServerRequestParameters(i,this.clientId,a,this.getRedirectUri(),e,r,s);return this.getCachedToken(c,t)},q.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,o=Array.from(this.config.framework.protectedResourceMap.keys());r<o.length;r++){var s=o[r];if(e.indexOf(s)>-1)return this.config.framework.protectedResourceMap.get(s)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?d.UrlUtils.getHostFromUri(e)===d.UrlUtils.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},q.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(E.TemporaryCacheKeys.INTERACTION_STATUS)===E.Constants.inProgress},q.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(E.TemporaryCacheKeys.INTERACTION_STATUS,E.Constants.inProgress):this.cacheStorage.removeItem(E.TemporaryCacheKeys.INTERACTION_STATUS)},q.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},q.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(E.TemporaryCacheKeys.INTERACTION_STATUS)===E.Constants.inProgress},q.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},q.prototype.getLogger=function(){return this.logger},q.prototype.setLogger=function(e){this.logger=e},q.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},q.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},q.prototype.getCurrentConfiguration=function(){if(!this.config)throw T.ClientConfigurationError.createNoSetConfigurationError();return this.config},q.prototype.getTokenType=function(e,t){var r=c.Account.compareAccounts(e,this.getAccount());return o.ServerRequestParameters.determineResponseType(r,t)},q.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):E.Constants.no_account,o=a.AuthCache.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(o,JSON.stringify(e))},q.prototype.setAuthorityCache=function(e,t){var r=a.AuthCache.generateAuthorityKey(e);this.cacheStorage.setItem(r,d.UrlUtils.CanonicalizeUri(t),this.inCookie)},q.prototype.updateCacheEntries=function(e,t,r,o){o&&this.cacheStorage.setItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.LOGIN_REQUEST,e.state),o,this.inCookie),r?this.cacheStorage.setItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(a.AuthCache.generateTemporaryCacheKey(E.TemporaryCacheKeys.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},q.prototype.getAccountId=function(e){return l.StringUtils.isEmpty(e.homeAccountIdentifier)?E.Constants.no_account:e.homeAccountIdentifier},q.prototype.buildIDTokenRequest=function(e){return{scopes:E.Constants.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},q.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return k.default.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,o=e.applicationVersion,s=e.telemetryEmitter;if(!r||!o||!s)throw T.ClientConfigurationError.createTelemetryConfigError(e);var n={platform:{applicationName:r,applicationVersion:o},clientId:t};return new k.default(n,s,this.logger)},q}();exports.UserAgentApplication=_;
},{"tslib":"vCxL","./cache/AccessTokenKey":"AF8p","./cache/AccessTokenValue":"FOs4","./ServerRequestParameters":"VFoY","./authority/Authority":"Xp9b","./ClientInfo":"ORXc","./IdToken":"ulwF","./cache/AuthCache":"mySt","./Account":"avWH","./ScopeSet":"gAsY","./utils/StringUtils":"fvWi","./utils/WindowUtils":"ETBp","./utils/TokenUtils":"hO0O","./utils/TimeUtils":"qVFc","./utils/UrlUtils":"vR5n","./utils/RequestUtils":"Keag","./utils/ResponseUtils":"JA3E","./authority/AuthorityFactory":"ju1D","./Configuration":"qVCj","./error/ClientConfigurationError":"c3Oq","./error/AuthError":"Oww8","./error/ClientAuthError":"WdOd","./error/ServerError":"MEau","./error/InteractionRequiredAuthError":"kf73","./AuthResponse":"mHyW","./telemetry/TelemetryManager":"kip2","./telemetry/ApiEvent":"FYTE","./utils/Constants":"kTX3","./utils/CryptoUtils":"Vl5M","./authority/TrustedAuthority":"qYUX","./utils/AuthCacheUtils":"eEzW"}],"dYTi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"UserAgentApplication",{enumerable:!0,get:function(){return e.UserAgentApplication}}),Object.defineProperty(exports,"Logger",{enumerable:!0,get:function(){return r.Logger}}),Object.defineProperty(exports,"LogLevel",{enumerable:!0,get:function(){return r.LogLevel}}),Object.defineProperty(exports,"Account",{enumerable:!0,get:function(){return t.Account}}),Object.defineProperty(exports,"Constants",{enumerable:!0,get:function(){return n.Constants}}),Object.defineProperty(exports,"ServerHashParamKeys",{enumerable:!0,get:function(){return n.ServerHashParamKeys}}),Object.defineProperty(exports,"Authority",{enumerable:!0,get:function(){return o.Authority}}),Object.defineProperty(exports,"CryptoUtils",{enumerable:!0,get:function(){return i.CryptoUtils}}),Object.defineProperty(exports,"UrlUtils",{enumerable:!0,get:function(){return u.UrlUtils}}),Object.defineProperty(exports,"WindowUtils",{enumerable:!0,get:function(){return s.WindowUtils}}),Object.defineProperty(exports,"AuthError",{enumerable:!0,get:function(){return c.AuthError}}),Object.defineProperty(exports,"ClientAuthError",{enumerable:!0,get:function(){return l.ClientAuthError}}),Object.defineProperty(exports,"ServerError",{enumerable:!0,get:function(){return p.ServerError}}),Object.defineProperty(exports,"ClientConfigurationError",{enumerable:!0,get:function(){return a.ClientConfigurationError}}),Object.defineProperty(exports,"InteractionRequiredAuthError",{enumerable:!0,get:function(){return f.InteractionRequiredAuthError}});var e=require("./UserAgentApplication"),r=require("./Logger"),t=require("./Account"),n=require("./utils/Constants"),o=require("./authority/Authority"),i=require("./utils/CryptoUtils"),u=require("./utils/UrlUtils"),s=require("./utils/WindowUtils"),c=require("./error/AuthError"),l=require("./error/ClientAuthError"),p=require("./error/ServerError"),a=require("./error/ClientConfigurationError"),f=require("./error/InteractionRequiredAuthError");
},{"./UserAgentApplication":"uwyl","./Logger":"R1Sx","./Account":"avWH","./utils/Constants":"kTX3","./authority/Authority":"Xp9b","./utils/CryptoUtils":"Vl5M","./utils/UrlUtils":"vR5n","./utils/WindowUtils":"ETBp","./error/AuthError":"Oww8","./error/ClientAuthError":"WdOd","./error/ServerError":"MEau","./error/ClientConfigurationError":"c3Oq","./error/InteractionRequiredAuthError":"kf73"}],"zSMc":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkToIE=exports.getLogger=exports.getScopes=exports.getUserAgentApp=void 0;var r=require("msal"),t=/[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}/,o=function(o){var n=o.clientId,i=o.tenantUrl,a=o.redirectUri;if(n&&t.test(n))return new r.UserAgentApplication({auth:e(e(e({},a&&{redirectUri:a}),i&&{authority:i}),{clientId:n,validateAuthority:!0,navigateToLoginRequestUrl:!1})})};exports.getUserAgentApp=o;var n=function(e){var r=e||[];return r.find(function(e){return"user.read"===e.toLowerCase()})||r.push("user.read"),r};exports.getScopes=n;var i=function(e){return function(r,t,o){if(e){var n="background-color: "+(o?"#990000":"#009900")+"; color: #ffffff; font-weight: 700; padding: 2px";console.groupCollapsed("MSLogin debug"),console.log("%c"+r,n),t&&console.log(t.message||t),console.groupEnd()}}};exports.getLogger=i;var a=function(){var e=window.navigator.userAgent,r=e.indexOf("MSIE "),t=e.indexOf("Trident/"),o=e.indexOf("Edge/");return r>0||t>0||o>0};exports.checkToIE=a;
},{"msal":"dYTi"}],"QLqa":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},t=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&t(r,e,o);return n(r,e),r},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function c(e){try{u(r.next(e))}catch(t){i(t)}}function a(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,a)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(a){i=[6,a],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var a=r(require("react")),u=c(require("./MicrosoftLoginButton")),s=require("./helpers"),l=function(t){var n=t.graphScopes,r=t.clientId,c=t.tenantUrl,l=t.redirectUri,h=t.children,p=t.buttonTheme,f=t.className,d=t.withUserData,b=void 0!==d&&d,v=t.authCallback,A=t.forceRedirectStrategy,D=void 0!==A&&A,E=t.prompt,g=t.debug,k=s.getUserAgentApp({clientId:r,tenantUrl:c,redirectUri:l}),y=s.getScopes(n),_=s.getLogger(g);if(!k)return _("Initialization","clientID broken or not provided",!0),null;a.useEffect(function(){k.handleRedirectCallback(function(e,t){!e&&t?(_("Fetch Azure AD 'token' with redirect SUCCEDEED",t),_("Fetch Graph API 'access_token' in silent mode STARTED"),m(!0)):(_("Fetch Azure AD 'token' with redirect FAILED",e,!0),v(e))})},[]);var w=function(){_("Login STARTED"),D||s.checkToIE()?F():S()},T=function(e){_("Fetch Graph API 'access_token' SUCCEDEED",e),b?C(e):(_("Login SUCCEDED"),v(null,e,k))},m=function(e){return o(void 0,void 0,void 0,function(){var t,n,r,o;return i(this,function(i){switch(i.label){case 0:i.trys.push([0,8,,9]),i.label=1;case 1:return i.trys.push([1,3,,7]),[4,k.acquireTokenSilent({scopes:y})];case 2:return t=i.sent(),T(t),[3,7];case 3:return n=i.sent(),_("Fetch Graph API 'access_token' in silent mode is FAILED",n,!0),e?(_("Fetch Graph API 'access_token' with redirect STARTED"),k.acquireTokenRedirect({scopes:y}),[3,6]):[3,4];case 4:return _("Fetch Graph API 'access_token' with popup STARTED"),[4,k.acquireTokenPopup({scopes:y})];case 5:r=i.sent(),T(r),i.label=6;case 6:return[3,7];case 7:return[3,9];case 8:return o=i.sent(),_("Login FAILED",o,!0),v(o),[3,9];case 9:return[2]}})})},S=function(){return o(void 0,void 0,void 0,function(){var e,t;return i(this,function(n){switch(n.label){case 0:_("Fetch Azure AD 'token' with popup STARTED"),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,k.loginPopup({scopes:y,prompt:E})];case 2:return e=n.sent(),_("Fetch Azure AD 'token' with popup SUCCEDEED",e),_("Fetch Graph API 'access_token' in silent mode STARTED"),m(),[3,4];case 3:return t=n.sent(),_("Fetch Azure AD 'token' with popup FAILED",t,!0),v(t),[3,4];case 4:return[2]}})})},F=function(){_("Fetch Azure AD 'token' with redirect STARTED"),k.loginRedirect({scopes:y,prompt:E})},C=function(t){return o(void 0,void 0,void 0,function(){var n,r;return i(this,function(o){switch(o.label){case 0:return n=t.accessToken,_("Fetch Graph API user data STARTED"),[4,fetch("https://graph.microsoft.com/v1.0/me",{method:"GET",headers:{Authorization:"Bearer "+n}})];case 1:return[4,o.sent().json()];case 2:return r=o.sent(),_("Fetch Graph API user data SUCCEDEED",r),_("Login SUCCEDED"),v(null,e(e({},r),t),k),[2]}})})};return h?a.default.createElement("div",{onClick:w},h):a.default.createElement(u.default,{buttonTheme:p||"light",buttonClassName:f,onClick:w})};exports.default=l;
},{"react":"JE2T","./MicrosoftLoginButton":"Ejll","./helpers":"zSMc"}],"DQsZ":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.MicrosoftLogin=void 0;var t=e(require("./MicrosoftLogin"));exports.MicrosoftLogin=t.default,exports.default=t.default;
},{"./MicrosoftLogin":"QLqa"}],"deHo":[function(require,module,exports) {
"use strict";var e=o(require("react")),t=r(require("react-microsoft-login"));function r(e){return e&&e.__esModule?e:{default:e}}function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var c=o?Object.getOwnPropertyDescriptor(e,i):null;c&&(c.get||c.set)?Object.defineProperty(r,i,c):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}var i=function(r){var n=r.message,o=(r.onSendMessage,n.data._plugin),i=o.clientId,c=o.redirectUri,u=o.scope,a=o.buttonTheme,s=o.debug;return e.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},e.createElement(t.default,{debug:s,clientId:i,authCallback:function(e,t){e&&console.error(e),console.log(t)},buttonTheme:a,redirectUri:c,graphScopes:u}))},c={match:"microsoft-auth",component:i,options:{fullwidth:!0}};window.cognigyWebchatMessagePlugins||(window.cognigyWebchatMessagePlugins=[]),window.cognigyWebchatMessagePlugins.push(c);
},{"react":"JE2T","react-microsoft-login":"DQsZ"}]},{},["deHo"], null)
//# sourceMappingURL=/microsoft-auth.webchat-plugin.js.map